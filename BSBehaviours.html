<!doctype html>
<html lang="en">

<head>
  <title>Blackstone Fortress AI App</title>
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸŽ²</text></svg>">
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="description" content="Blackstone Fortress AI behavior generator and helper app">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <style>
    /* 3-column header: empty | middle (stats+buttons+checkbox) | right (stats-matrix) */
    .card-header {
      display: grid;
      grid-template-columns: 35% 30% 35%;
      gap: 12px;
      align-items: start;
      width: 100%;
      min-height: 160px;
      box-sizing: border-box;
    }

    .card-header>.mid-column,
    .card-header>ul.nav,
    .card-header>.form-check {
      grid-column: 2;
    }

    /* ensure the middle area stacks and centers its contents */
    .card-header .mid-column,
    .card-header ul.nav {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 0;
    }

    /* keep buttons centered and wrap if needed */
    .mid-column .btn-group-sm,
    .card-header ul.nav .btn-group-sm {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 6px;
      width: 100%;
      box-sizing: border-box;
    }

    /* show stats-line above the buttons while keeping it in the same container */
    .mid-column .btn-group-sm>.stats-display,
    .card-header ul.nav .btn-group-sm>.stats-display {
      order: -1;
      width: 100%;
      text-align: center;
      margin-bottom: 6px;
    }

    .card .card-body .card-text {
      white-space: normal;
      /* allow wrapping */
      display: block;
      line-height: 1.2em;
      min-height: calc(2 * 1.2em);
      /* reserve space for two lines */
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    /* Right column: stats matrix â€” left aligned inside column and about 500px wide */
    .stats-table {
      grid-column: 3;
      justify-self: start;
      /* align left inside right column */
      align-self: start;
      /* align to top of header */
      width: 600px;
      /* preferred width to fit text */
      max-width: 48vw;
      min-height: 120px;
      box-sizing: border-box;
      margin-left: 6px;
      padding: 0;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    /* keep the table at top of the stats-table and allow the special rules to scroll */
    .stats-table table {
      width: 100%;
      max-height: 160px;
      /* prevent table from growing indefinitely */
      overflow: visible;
      /* table shows fully; if it gets tall, special rules area will scroll */
      display: block;
    }

    /* special rules under stats-matrix */
    .stats-special {
      margin: 0;
      padding: 6px 0 0 0;
      text-align: left;
      border-top: 1px solid rgba(0, 0, 0, 0.06);
      font-size: 0.85rem;
      color: #444;
      overflow-y: auto;
    }

    .stats-special .rule-row {
      margin: 4px 0;
    }

    .stats-special .rule-row i {
      /* all special-rules italic */
      font-style: italic;
      display: block;
    }

    .stats-special .rule-row strong {
      /* key bold inside italic */
      font-weight: 600;
      margin-right: 6px;
      font-style: italic;
      /* keep key italic too so whole line is italic with bold key */
    }

    /* dice icon fills */
    .dice-icon {
      font-size: 0.95rem;
      display: inline-block;
      width: 1.1em;
      height: 1.1em;
      line-height: 1.1em;
      text-align: center;
      border-radius: 2px;
    }

    .dice-pentagon {
      color: #7ec8ff;
    }

    .dice-triangle {
      color: #c9a3ff;
    }

    .dice-square {
      color: #bfc3c6;
    }

    #toggleHostileCollapseButton {
      min-width: 150px;
      /* make button wider so label changes don't shift layout */
      white-space: nowrap;
      /* prevent label wrapping */
      padding: .375rem .9rem;
      background-color: #6ea8d6;
      /* softer light-blue (less prominent than btn-dark) */
      color: #fff;
      border: 1px solid rgba(0, 0, 0, 0.08);
      box-shadow: none;
    }

    .special-rules-list ul {
      list-style-type: none;
      padding-left: 0;
      font-style: italic;
      text-align: left;
      margin-left: 0;
    }



    #toggleHostileCollapseButton:hover,
    #toggleHostileCollapseButton:focus {
      background-color: #5b95cf;
      color: #fff;
      box-shadow: none;
    }
  </style>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" />
</head>


<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
  integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

<script>
  var modifier = 0;
  var showHostile = 0;

  var holdResult = {
    result: "HOLD",
    descr: "Do nothing.",
    note: ""
  }

  var advanceResult = {
    result: "ADVANCE",
    descr: "Move towards the closest explorer. Then attack the closest explorer that is in range of and visible to this hostile.",
    note: ""
  }

  var onslaughtResult = {
    result: "ONSLAUGHT",
    descr: "Attack the closest explorer that is in range of and visible to this hostile. Then attack the closest explorer that is in range of and visible to this hostile (this may be a different target if the first explorer is taken out of action or another explorer is equally close).",
    note: ""
  }

  var sneakResult = {
    result: "SNEAK",
    descr: "Make a move as close as possible to an explorer without entering a hex that is visible to any explorer.",
    note: ""
  }

  var chargeResult = {
    result: "CHARGE",
    descr: "Move towards the closest explorer. Then attack an explorer that is adjacent and visible to this hostile. If there are no explorers adjacent and visible to this hostile, move towards the closest explorer a second time.",
    note: ""
  }

  var aimResult = {
    result: "AIM",
    descr: "Attack the furthest explorer that is in range of and visible to this hostile. That attack ignores cover.",
    note: ""
  }

  var fallbackResult = {
    result: "FALL BACK",
    descr: "Double this hostile's Move value when they take this action. If this hostile can make a move that ends in a hex that is not visible to any explorers, they do so. If they cannot, they attack the closest explorer that is in range and visible to this hostile.",
    note: ""
  }

  var furyResult = {
    result: "FURY",
    descr: "Take an Onslaught action. Re-roll failed attack rolls for that action.",
    note: ""
  }

  var rushResult = {
    result: "RUSH",
    descr: "Move towards the closest explorer. Then take a Charge action.",
    note: ""
  }

  var overchargeResult = {
    result: "OVERCHARGE",
    descr: "Make an overcharged Plasma Pistol attack against the closest explorer that is in range of and visible to Obsidius Mallex.",
    note: ""
  }

  var rechargeResult = {
    result: "RECHARGE",
    descr: "Remove a wound counter from the Negavolt Cultist. If the Negavolt Cultist does not have a wound counter, treat this result as an Advance result instead.",
    note: ""
  }

  var alertResult = {
    result: "ALERT",
    descr: "Increase the threat level by 1 and then take an Onslaught action. If the threat level is 3, take an Onslaught action and re-roll failed attack rolls for that action instead.",
    note: ""
  }

  var pounceResult = {
    result: "POUNCE",
    descr: "If there is an explorer adjacent and visible to this Ur-Ghul, take an Onslaught action. Otherwise, take a Charge action. Re-roll failed attack rolls for whichever action is taken.",
    note: ""
  }

  var disruptResult = {
    result: "DISRUPT",
    descr: "One unspent activation or destiny dice chosen by the hostile player is discarded and cannot be spent this turn. If no unspent activation or destiny dice are available, one explorer chosen by the hostile player suffers a wound.",
    note: ""
  }

  var regenerateResult = {
    result: "REGENERATE",
    descr: "Remove a wound counter from the Rogue Psyker. If the Rogue Psyker does not have a wound counter, treat this result as a Disrupt result instead.",
    note: ""
  }

  var empowerResult = {
    result: "EMPOWER",
    descr: "Place the empowered marker beside the Rogue Psyker. If the Rogue Psyker is already empowered, treat this result as a Disrupt instead. The Rogue Psyker remains empowered until they suffer a wound or grievous wound.",
    note: ""
  }

  var annihilateResult = {
    result: "ANNIHILATE",
    descr: "Place the empowered marker beside the Rogue Psyker. Then attack an explorer that is adjacent and visible to this hostile. Re-roll failed attack rolls for that attack. The Rogue Psyker remains empowered until they suffer a wound or grievous wound.",
    note: ""
  }

  var rapidfireResult = {
    result: "RAPID FIRE",
    descr: "Take an Onslaught action. Re-roll failed attack rolls for that action.",
    note: ""
  }

  var swipeResult = {
    result: "SWIPE",
    descr: "Make an attack against each explorer that is adjacent and visible to the Ambull.",
    note: ""
  }

  var tunnelResult = {
    result: "TUNNEL",
    descr: "Remove the Ambull from the battlefield and place the Ambull location marker on the hex it was removed from - any remaining actions during this activation are lost. The next time the initiative card for the Ambull is reached, do not roll on the behaviour table for the Ambull's first action. Instead, the Ambull is placed in a hex as close as possible to the explorer that is cloest to the Ambull location marker. Once the Ambull has been placed, remove the Ambull location marker and roll for the Ambull's second action as normal. ",
    note: ""
  }

  var borewyrmTunnelResult = {
    result: "TUNNEL",
    descr: "Remove the Borewyrm Infestation from the board and place it in the same hex as the discovery marker that is furthest from any explorers or other hostiles(other than the Ambull or any other Borewyrm Infestations). If this is not possible, treat this result as a Sneak result instead.",
    note: ""
  }

  var consumeResult = {
    result: "CONSUME",
    descr: "Double this hostile's Move value when they take this action. Move the Borewyrm Infestation towards the nearest discovery marker. If it finishes this move in a hex with a discovery marker, remove that discovery marker, then remove any wound counters next to this Borewyrm Infestation. If there are no discovery markers or the only discovery markers on the board are showing the <?> side, treat this result as a Sneak result instead.",
    note: ""
  }

  var executeTheWeakResult = {
    result: "EXECUTE THE WEAK",
    descr: "If there are no Traitor Guardsman hostiles visible to the Traitor Commissar, treat this result as Charge instead. Otherwise, the nearest Traitor Guardsman that is visible to the Traitor Commissar is slain. Place the motivation marker in the same hex as the slain Traitor Guardsman before it is removed. Add 2 to behaviour rolls (to a maximum of 20) for all Traitor Guardsman hostiles within 6 hexes of the motivation marker. Remove the motivation marker at the start of the Traitor Commissar's next activation.",
    note: ""
  }

  var guardResult = {
    result: "GUARD",
    descr: "Move the Chaos Ogryn towards the Traitor Commissar.",
    note: ""
  }

  var crushResult = {
    result: "CRUSH",
    descr: "Move towards the closest explorer. Then attack an explorer that is adjacent and visible to this hostile. If there are no explorers adjacent and visible to this hostile, move towards the closest explorer a second time. If the Chaos Ogryn ends either of these moves adjacent to any explorers, those explorers are stunned.",
    note: ""
  }

  var lurchResult = {
    result: "LURCH",
    descr: "Take a Charge action. Re-roll failed attack rolls for that action.",
    note: ""
  }

  var virulentBiteResult = {
    result: "VIRULENT BITE",
    descr: "Take an Onslaught action. Re-roll failed attack rolls for that action.",
    note: ""
  }

  var plagueAnnihilateResult = {
    result: "ANNIHILATE",
    descr: "Take an Onslaught action. Hostiles with a  Boltgun re-roll failed attack rolls for this action. hostiles with a Plasma Gun do not make an Onslaught action; instead, make an overcharged Plasma Gun attack against the closest explorer that is in range and visible to that hostile.",
    note: ""

  }

  var steadyAdvanceResult = {
    result: "STEADY ADVANCE",
    descr: "Move towards the closest explorer. Then attack the furthest explorer that is in range of and visible to this hostile(even if there is an adjacent explorer). That attack ignores cover.",
    note: ""
  }

  var ritesOfPossessionResult = {
    result: "RITES OF POSSESSION",
    descr: "One unspent activation or destiny dice chosen by the hostile player (or the leader, if there is no hostile player) is discarded and cannot be spent this turn. If no unspent activation or destiny dice are available, one explorer chosen by the hostile player suffers a grievous wound.",
    note: ""
  }

  var warpfireResult = {
    result: "WARPFIRE BRAZIERS",
    descr: "All adjacent explorers suffer 1 grievous wound.",
    note: ""
  }

  var warpsurgeResult = {
    result: "WARPSURGE",
    descr: "Remove a wound counter from the Greater Possessed. If the Greater Possessed does not have a wound counter, treat this result as a Charge result instead.",
    note: ""
  }

  var overwhelmResult = {
    result: "OVERWHELM",
    descr: "Move towards the cloest explorer that has another Cultist hostile adjacent to it. Then attack an explorer that is adjacent and visible to this hostile; if there are no explorers adjacent and visible to this hostile, move towards the cloest explorer that has another Cultist hostile adjacent to it a second time. If there are no explorers with another Cultist hostile adjacent to them, treat this result as Charge instead.",
    note: ""
  }

  var fullautoResult = {
    result: "FULL-AUTO",
    descr: "Make an attack roll against each explorer adjacent and visible to this hostile. If only one explorer is adjacent, treat this as Onslaught instead.",
    note: ""
  }

  var firestormResult = {
    result: "FIRESTORM",
    descr: "Place a firestorm marker beside the Cultist Firebrand. While a firestorm marker is beside this Cultist Firebrand, each time an explorer moves into a hex that is within 2 hexes of them, the Cultist Firebrand makes a Hellfire Torch attack against that explorer. After that attack is resolved, that explorer can continue to move. Remove the firestorm marker the next time the Cultist Firebrand is activated.",
    note: ""
  }

  var allShallBurnResult = {
    result: "ALL SHALL BURN",
    descr: "Make a â–¡ attack roll against each explorer and hostile within two hexes of and visible to the Cultist Firebrand.",
    note: ""
  }

  var scuttleResult = {
    result: "SCUTTLE",
    descr: "Move towards the closest explorer. Then attack the closest explorer that is in range of and visible to this hostile. If there is no explorer in range and visible to this hostile, move towards the closest explorer a second time, then attack the closest explorer that is in range and visible to this hostile.",
    note: ""
  }

  var hoverdronesResult = {
    result: "HOVER DRONES",
    descr: "If there is already a Hover Drones token in the same hex as this hostile, treat this as a Charge result instead. Otherwise, place a Hover Drones token in the same hex as this hostile. This token moves with this hostile - at the end of the hostiles move place the Hover Drones token in the same hex as this hostile. When this hostile is the target of an explorer that is 2 or more hexes away, if there is a Hover Drones token in that hex, the attack has no effect and you remove the Hover Drones token.",
    note: ""
  }

  var commandResult = {
    result: "COMMAND",
    descr: "If there are any Awakened Spindle Drones on the battlefield, activate each Awakened Spindle Drone immediately after this hostile's activation. This is in addition to the Awakened Spindle Drones' activations this phase. If there are no Awakened Spindle Drones on the battlefield, treat this as an Advance result instead.",
    note: ""
  }

  var observeResult = {
    result: "OBSERVE",
    descr: "Double this hostile's Move value when they take this action. Move towards the closest explorer.",
    note: ""
  }

  var steadAdvanceResult2 = {
    result: "STEADY ADVANCE",
    descr: "Double this hostile's Move value when they take this action. Move towards the cloest explorer, then attack the closest explorer that is in range of and visible to the Archivist.",
    note: ""
  }

  var almightyBlowResult = {
    result: "ALMIGHTY BLOW",
    descr: "Make one Eradicator Glove weapon action against one visible, adjacent explorer. When rolling for this attack action, resolve each result on the action dice one at a time, resolving any successes before any critical successes.",
    note: ""
  }

  var eventKeySet = [
    //Hidden Vault EventHV
    { quest: "EventHV", eventRoll: [1], eventResultKey: "AllIsDust1" },
    { quest: "EventHV", eventRoll: [2, 3], eventResultKey: "UnfulfilledDestiny" },
    { quest: "EventHV", eventRoll: [4, 5, 6], eventResultKey: "NotDeadYet" },
    { quest: "EventHV", eventRoll: [7, 8, 9, 10], eventResultKey: "ChangingConditions" },
    { quest: "EventHV", eventRoll: [11, 12, 13, 14], eventResultKey: "EscapeChamber" },
    { quest: "EventHV", eventRoll: [15, 16, 17], eventResultKey: "Inspiration" },
    { quest: "EventHV", eventRoll: [18, 19], eventResultKey: "HeroicEffort" },
    { quest: "EventHV", eventRoll: [20], eventResultKey: "LuckyFind" },

    //Black Shrines EventBS
    { quest: "EventBS", eventRoll: [1], eventResultKey: "AllIsDust2" },
    { quest: "EventBS", eventRoll: [2, 3], eventResultKey: "UnfulfilledDestiny" },
    { quest: "EventBS", eventRoll: [4, 5, 6], eventResultKey: "NotDeadYet" },
    { quest: "EventBS", eventRoll: [7, 8, 9, 10], eventResultKey: "ChangingConditions" },
    { quest: "EventBS", eventRoll: [11, 12, 13, 14], eventResultKey: "AlarmTripped" },
    { quest: "EventBS", eventRoll: [15, 16, 17], eventResultKey: "Inspiration" },
    { quest: "EventBS", eventRoll: [18, 19], eventResultKey: "HeroicEffort" },
    { quest: "EventBS", eventRoll: [20], eventResultKey: "LuckyFind" },

    //Seethe EventSH
    { quest: "EventSH", eventRoll: [1], eventResultKey: "JustifiedParanoia" },
    { quest: "EventSH", eventRoll: [2, 3], eventResultKey: "SignsOfBetrayal" },
    { quest: "EventSH", eventRoll: [4, 5, 6], eventResultKey: "NotDeadYet" },
    { quest: "EventSH", eventRoll: [7, 8, 9, 10], eventResultKey: "ConfirmingSuspicions" },
    { quest: "EventSH", eventRoll: [11, 12, 13, 14], eventResultKey: "MutableLandscape" },
    { quest: "EventSH", eventRoll: [15, 16, 17], eventResultKey: "Inspiration" },
    { quest: "EventSH", eventRoll: [18, 19], eventResultKey: "HeroicEffort" },
    { quest: "EventSH", eventRoll: [20], eventResultKey: "GrowingFaith" },

    //Shardquake EventSQ
    { quest: "EventSQ", eventRoll: [1], eventResultKey: "JustifiedParanoia" },
    { quest: "EventSQ", eventRoll: [2, 3, 4, 5, 6, 7], eventResultKey: "FluctuatingCorridors" },
    { quest: "EventSQ", eventRoll: [8, 9, 10, 11, 12], eventResultKey: "PlungingPillars" },
    { quest: "EventSQ", eventRoll: [13, 14, 15, 16, 17], eventResultKey: "SuddenRelocation" },
    { quest: "EventSQ", eventRoll: [18], eventResultKey: "UnexpectedArrivals" },
    { quest: "EventSQ", eventRoll: [19], eventResultKey: "ImpalingShards" },
    { quest: "EventSQ", eventRoll: [20], eventResultKey: "UncoveredWealth" },

    //Ascension No Hostiles EventA0
    { quest: "EventA0", eventRoll: [1, 2, 3, 4, 5], eventResultKey: "Challenge" },
    { quest: "EventA0", eventRoll: [6, 7], eventResultKey: "Inspiration" },
    { quest: "EventA0", eventRoll: [8, 9, 10, 11], eventResultKey: "IncreasingInstability" },
    { quest: "EventA0", eventRoll: [12, 13, 14, 15], eventResultKey: "TheFortressStirs" },
    { quest: "EventA0", eventRoll: [16, 17, 18, 19, 20], eventResultKey: "Recovery" },


    //Ascension With Hostiles EventA1
    { quest: "EventA1", eventRoll: [1, 2], eventResultKey: "AllIsDust1" },
    { quest: "EventA1", eventRoll: [3, 4], eventResultKey: "UnfulfilledDestiny" },
    { quest: "EventA1", eventRoll: [5, 6], eventResultKey: "DesperateLunge" },
    { quest: "EventA1", eventRoll: [7, 8, 9, 10], eventResultKey: "IncreasingInstability" },
    { quest: "EventA1", eventRoll: [11, 12, 13, 14], eventResultKey: "TheFortressStirs" },
    { quest: "EventA1", eventRoll: [15, 16, 17], eventResultKey: "Inspiration" },
    { quest: "EventA1", eventRoll: [18, 19], eventResultKey: "HeroicEffort" },
    { quest: "EventA1", eventRoll: [20], eventResultKey: "LuckyFind" },

  ];



  var eventResults = [
    { eventResultKey: "AllIsDust1", descr: "ALL IS DUST", details: "If any discovery markers are still on the battlefield, the leader must discard one of them. If there are no discovery markers, each explorer loses 1 inspiration point, to a minimum of 0." },
    { eventResultKey: "AllIsDust2", descr: "ALL IS DUST", details: "All explorers lose 1 inspiration point (to a minimum of 0)." },
    { eventResultKey: "UnfulfilledDestiny", descr: "UNFULFILLED DESTINY", details: "Do not make a destiny roll at the start of the next turn." },
    { eventResultKey: "NotDeadYet", descr: "NOT DEAD YET", details: "The leader must pick one hostile that was slain during the combat and has not returned to the battlefield, and then deploy them as close to an explorer as possible." },
    { eventResultKey: "ChangingConditions", descr: "CHANGING CONDITIONS", details: "Draw an encounter card. If the card has a twist, it applies for the rest of the combat. If not, there is no effect." },
    { eventResultKey: "AlarmTripped", descr: "ALARM TRIPPED", details: "Until the end of the next turn, re-roll reinforcement rolls of 11-20 that do not cause hostiles to arrive." },
    { eventResultKey: "EscapeChamber", descr: "ESCAPE CHAMBER", details: "The leader replaces the portal furthest from any explorers with a maglev transport escape chamber. If more than one portal is equally far from the explorers, the leader can pick which one to replace. If this even has already been rolled, or if an explorer has used a Summon action, there is no effect." },
    { eventResultKey: "Inspiration", descr: "INSPIRATION", details: "The leader picks an explorer. That explorer receives 1 inspiration point." },
    { eventResultKey: "HeroicEffort", descr: "HEROIC EFFORT", details: "The leader picks an explorer that is out of action. Deploy the explorer in the same hex as another explorer or as close to another explorer as possible, and then make a vitality roll for them. If no explorers are out of action, the leader picks an explorer. Make a vitality roll for that explorer." },
    { eventResultKey: "LuckyFind", descr: "LUCKY FIND", details: "The leader picks an explorer. That explorer draws a discovery card." },
    { eventResultKey: "JustifiedParanoia", descr: "JUSTIFIED PARANOIA", details: "Lose 2 trust. Then shift the battlefield." },
    { eventResultKey: "SignsOfBetrayal", descr: "SIGNS OF BETRAYAL", details: "Lose 1 trust." },
    { eventResultKey: "ConfirmingSuspicions", descr: "CONFIRMING SUSPICIONS", details: "An explorer chosen by the leader loses 1 inspiration point, or lose 1 trust." },
    { eventResultKey: "MutableLandscape", descr: "MUTABLE LANDSCAPE", details: "Shift the battlefield." },
    { eventResultKey: "GrowingFaith", descr: "GROWING FAITH", details: "Gain 1 trust." },
    { eventResultKey: "ValuableDiscovery", descr: "VALUABLE DISCOVERY", details: "The leader picks an explorer. That explorer draws a discovery card. If it is a Shardquake card, ignore it and shuffle that card back into the discovery deck." },
    { eventResultKey: "FluctuatingCorridors", descr: "FLUCTUATING CORRIDORS", details: "Shift the battlefield." },
    { eventResultKey: "PlungingPillars", descr: "PLUNGING PILLARS", details: "Roll the Blackstone dice for each chamber that contains hostiles or explorers. On an 11+ every explorer in that chamber suffers 1 wound, and every hostile in that chamber suffers 1 damage. Finall, shift the battlefield." },
    { eventResultKey: "SuddenRelocation", descr: "SUDDEN RELOCATION", details: "The hostile player (or the leader if there is no hostile player) must choose one explorer. That explorer is removed from the battlefield and placed on the furthest empty hex from their current position. If this cannot be done, ignore this result." },
    { eventResultKey: "UnexpectedArrivals", descr: "UNEXPECTED ARRIVALS", details: "Immediately make one reinforcement roll for each hostile group." },
    { eventResultKey: "ImpalingShards", descr: "IMPALING SHARDS", details: "Roll the Blackstone dice for each explorer (except the Archivist). On a 1-5, that explorer suffers 1 grievous wound." },
    { eventResultKey: "UncoveredWealth", descr: "UNCOVERED WEALTH", details: "The leader picks an explorer. That explorer draws 3 discovery cards and keeps up to 2, shuffling the remaining cards back into the discovery deck. An explorer cannot keep any Shardquake cards - they are shuffled back into the discovery deck. Finally, shift the battlefield." },
    { eventResultKey: "IncreasingInstability", descr: "INCREASING INSTABILITY", details: "At the beginning of the next event phase, if there is an unstable fragment, the leader must remove two tiles from the unstable fragment, rather than one. Place an unstable counter on the leader marker as a reminder. If there is only one tile in the unstable fragment, or if there is no unstable fragment, there is no effect." },
    { eventResultKey: "TheFortressStirs", descr: "THE FORTRESS STIRS", details: "If there is no unstable fragment, determine which access hex is furthest from the explorers. If there is more than one access hex furthest from the explorers, the leader picks one of them. The leader resolves the Explore (1+) action as if there were an explorer in that hex taking that action. If there is an unstable fragment, there is no effect." },
    { eventResultKey: "DesperateLunge", descr: "DESPERATE LUNGE", details: "The leader picks one hostile on the battlefield and activates that hostile." },
    { eventResultKey: "Challenge", descr: "CHALLENGE", details: "Draw the top card of the Exploration deck and resolve that challenge." },
    { eventResultKey: "Recovery", descr: "RECOVERY", details: "Resolve a recovery step as described on page 11 of the Blackstone Fortress rules." }
  ];

  function generateEventResultV2(rollModifier, quest, eventResultsObject, eventDetailsObject) {
    var rollResult = rollD20(rollModifier);
    var eventResultKey = "";


    for (var i = 0; i < eventKeySet.length; i++) {
      var event = eventKeySet[i];
      if (quest == event.quest) {
        for (var x = 0; x < event.eventRoll.length; x++) {
          if (rollResult == event.eventRoll[x]) {
            eventResultKey = event.eventResultKey;
            break;
          }
        }
      }

    }

    for (var y = 0; y < eventResults.length; y++) {
      var eventResult = eventResults[y];
      if (eventResultKey == eventResult.eventResultKey) {
        eventResultsObject.text(rollResult + " - " + eventResults[y].descr);
        eventDetailsObject.text(eventResults[y].details);
        break;
      }
    }
  }

  // toggle helper: updates label to reflect current visible collapse state
  function updateToggleLabel() {
    var $visible = $('#hostilesButtonGroup > .container-fluid:visible');
    var $btn = $('#toggleHostileCollapseButton');
    if ($visible.length === 0) {
      $btn.prop('disabled', true).text('Expand All');
      return;
    }
    var anyCollapsed = false;
    $visible.each(function () {
      if (!$(this).find('.collapse.multi-collapse').hasClass('show')) anyCollapsed = true;
    });
    $btn.prop('disabled', false).text(anyCollapsed ? 'Expand All' : 'Collapse All');
  }


  function generateEventResult(rollModifier, eventResultsObject, eventDetailsObject) {
    var rollResult = rollD20(rollModifier);
    var indexValue;
    if (rollResult == 1) {
      indexValue = 0;
    }//2-3
    else if (rollResult > 1 && rollResult < 4) {
      indexValue = 1;
    }//4-6
    else if (rollResult > 3 && rollResult < 7) {
      indexValue = 2;
    }//7-10
    else if (rollResult > 6 && rollResult < 11) {
      indexValue = 3;
    }//11-14
    else if (rollResult > 10 && rollResult < 15) {
      indexValue = 4;
    }//15-17
    else if (rollResult > 14 && rollResult < 18) {
      indexValue = 5;
    }//18-19
    else if (rollResult > 17 && rollResult < 20) {
      indexValue = 6;
    }//20
    else {
      indexValue = 7;
    }

    eventResultsObject.text(rollResult + " - " + eventResults[indexValue].descr);
    eventDetailsObject.text(eventResults[indexValue].details);
  }
  // helper: render known icons as colored filled glyphs
  function renderIconHtml(raw) {
    if (!raw) return '';
    var s = raw.toString();
    // detect shapes: support both white and black unicode variants
    if (s.indexOf('â¬ ') !== -1 || s.indexOf('â¬Ÿ') !== -1) {
      return '<span class="dice-icon dice-pentagon">&#x2B1F;</span>'; // black pentagon
    }
    if (s.indexOf('â–³') !== -1 || s.indexOf('â–²') !== -1) {
      return '<span class="dice-icon dice-triangle">&#x25B2;</span>'; // black triangle
    }
    if (s.indexOf('â–¡') !== -1 || s.indexOf('â– ') !== -1) {
      return '<span class="dice-icon dice-square">&#x25A0;</span>'; // black square
    }
    // fallback: return escaped text
    return $('<div/>').text(s).html();
  }

  // helper: replace "(1)" / "(2)" with HTML superscripts in already-escaped text
  function formatSuperscriptsEscaped(escapedHtml) {
    if (!escapedHtml) return escapedHtml;
    return escapedHtml
      .replace(/\(1\)/g, '<sup>1</sup>')
      .replace(/\(2\)/g, '<sup>2</sup>')
      .replace(/\(3\)/g, '<sup>3</sup>')
      .replace(/\(4\)/g, '<sup>4</sup>');
  }

  // helper: format a cell or rule text -> escaped HTML + superscripts + colored icon spans
  function formatCellHtml(raw) {
    if (raw === undefined || raw === null) return '';
    var s = raw.toString();

    // escape
    var esc = $('<div/>').text(s).html();

    // convert (n) -> <sup>n</sup>
    esc = formatSuperscriptsEscaped(esc);

    // replace known unicode shapes with coloured spans (keeps other text intact)
    esc = esc
      .replace(/â¬ |â¬Ÿ/g, '<span class="dice-icon dice-pentagon">&#x2B1F;</span>') // pentagon variants
      .replace(/â–³|â–²/g, '<span class="dice-icon dice-triangle">&#x25B2;</span>') // triangle variants
      .replace(/â–¡|â– /g, '<span class="dice-icon dice-square">&#x25A0;</span>');   // square variants

    return esc;
  }

  // Default stats matrix header
  var defaultStatsHeader = ["Weapon", "Range 1", "Range 2-3", "Range 4+"];
  // Build/populate the table in the container with id "<HOSTILE>StatsTable"
  function populateStatsMatrix(hostile) {
    if (!hostile) return;
    var hostileId = hostile.id || '';
    var $container = $('#' + hostileId + 'StatsTable');
    if ($container.length === 0) {
      console.warn('populateStatsMatrix: missing container for', hostileId);
      return;
    }

    // choose header: hostile override or default
    var headerData = (hostile.statsMatrix && hostile.statsMatrix.header && hostile.statsMatrix.header.length)
      ? hostile.statsMatrix.header.slice()
      : defaultStatsHeader.slice();

    // ensure at least 4 columns in header
    if (headerData.length < 4) {
      while (headerData.length < 4) headerData.push('');
    }

    var $table = $('<table/>').addClass('table table-sm mb-0');
    var $thead = $('<thead/>');
    var $hrow = $('<tr/>');
    headerData.forEach(function (h) {
      // header cells may also contain (n) references, format them
      $hrow.append($('<th/>').html(formatCellHtml(h)));
    });
    $thead.append($hrow);
    $table.append($thead);

    var $tbody = $('<tbody/>');

    var rows = (hostile.statsMatrix && hostile.statsMatrix.rows && hostile.statsMatrix.rows.length) ? hostile.statsMatrix.rows : null;

    if (!rows) {
      // produce a single empty row if none provided
      var $r = $('<tr/>');
      for (var i = 0; i < headerData.length; i++) $r.append($('<td/>').html(''));
      $tbody.append($r);
    } else {
      rows.forEach(function (row) {
        var $r = $('<tr/>');
        // first (label) cell - format (superscripts etc)
        $r.append($('<td/>').html(formatCellHtml(row.label || '')));
        // remaining cells (format with icons/superscripts)
        for (var c = 1; c < headerData.length; c++) {
          var rawCell = (row.cols && row.cols[c - 1] !== undefined) ? row.cols[c - 1] : '';
          $r.append($('<td/>').html(formatCellHtml(rawCell)));
        }
        $tbody.append($r);
      });
    }
    $table.append($tbody);

    // prepare special rules block (clear old content first)
    var $special = $('<div/>').addClass('stats-special');
    var specialRules = (hostile.statsMatrix && hostile.statsMatrix.specialRules && hostile.statsMatrix.specialRules.length) ? hostile.statsMatrix.specialRules : null;

    if (specialRules && specialRules.length) {
      specialRules.forEach(function (rule) {
        var key = rule.key || '';
        var value = rule.value || '';
        // format both key and value (superscripts + icons if present)
        var escKey = formatCellHtml(key);
        var escVal = formatCellHtml(value);
        // whole line italic, key bold (and italic)
        var $row = $('<div/>').addClass('rule-row').html('<i><strong>' + escKey + '</strong>: ' + escVal + '</i>');
        $special.append($row);
      });
    } else {
      // if no special rules, keep a single empty line so layout remains predictable
      $special.append($('<div/>').addClass('rule-row').html('<i></i>'));
    }

    // insert table + special rules into container
    $container.empty().append($table).append($special);
  }

  function populateSpecialRules(hostile) {
    if (!hostile) return;
    var hostileId = hostile.id || '';

    // Find the target container
    var $container = $('#' + hostileId + 'SpecialRules');

    // Clear any existing content
    $container.empty();

    // Check if specialRules exist and are non-empty
    if (hostile.specialRules && hostile.specialRules.length > 0) {
      // Create the header
      var $header = $('<h5>').text('Special Rules').css({
        'font-weight': 'bold',
        'margin-top': '10px'
      });

      // Create the list
      var $list = $('<ul>').css({
        'font-style': 'italic',
        'margin-left': '20px',
        'list-style-type': 'none',
        'padding-left': '0',
      });

      // Loop through all special rules
      hostile.specialRules.forEach(function (rule) {
        var $item = $('<li>');
        var $key = $('<strong>').text(rule.key + ': ');
        var $value = $('<span>').text(rule.value);

        $item.append($key).append($value);
        $list.append($item);
      });

      // Append everything to the container
      $container.append($header).append($list);
    }
  }


  // Traitor Guardsmen
  var traitorGuardHostile = {
    name: "Traitor Guardsmen",
    id: "TG",
    size: "SMALL",
    move: 2,
    wounds: 2,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Flamer(1)", cols: ["â¬ ", "â¬ ", "Move Up(2)"] },
        { label: "Lasgun", cols: ["â–³", "â–³", "â–³"] },
        { label: "Pistol & Melee Weapon", cols: ["â–³â–³", "â–¡", "â–¡"] },
        { label: "Grenade", cols: ["â–¡", "â–³", "â–³"] }
      ],
      specialRules: [
        { key: 'Blast(1)', value: 'Ignores cover. Hits the entire hex, not just the target.' },
        { key: 'Move Up(2)', value: 'The flamer cannot be fired from this range, move towards closest explorer instead.' }
      ]
    },
    specialRules: [
      { key: 'Traitor Guardsman Sergeant', value: 'Add 1 to the wounds value of a Traitor Guardsman Sergeant.' },
      { key: 'Traitor Guardsman Groups', value: 'Cannot include more than 1 Sergeant and 1 Flamer. If a group has five or more miniatures, it must include a Sergeant and a Flamer if they are available.' }
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 7)
        return sneakResult;
      else if (rollResult > 6 && rollResult < 10)
        return advanceResult
      else if (rollResult > 9 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 20)
        return chargeResult
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return onslaughtResult;
      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return furyResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 4)
        return aimResult;
      else if (rollResult > 3 && rollResult < 7)
        return aimResult;
      else if (rollResult > 6 && rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return furyResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return onslaughtResult;
      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return chargeResult;
      else if (rollResult > 12 && rollResult < 20)
        return chargeResult;
      else
        return furyResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return advanceResult;
      else if (rollResult > 3 && rollResult < 7)
        return advanceResult;
      else if (rollResult > 6 && rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 13)
        return aimResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return rushResult;
    }


  };

  //Negavolt cultist
  var negavoltCultistHostile = {
    name: "Negavolt cultist",
    id: "NG",
    size: "LARGE",
    move: 3,
    wounds: 2,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Electro-goad(1)", cols: ["â–³", "-", "-"] }
      ],
      specialRules: [
        { key: 'Lightning Arc(1)', value: 'Ignore cover. In addition, no defense roll can be made against a wound or grievous wound inflicted by an Electro-goad attack.' }
      ]
    },
    specialRules: [
      { key: 'Voltagheist Field', value: 'Roll the Blackstone dice each time a wound or grievous wound is suffered by a Negavolt Cultist. Add 2 to the dice roll for each other Negavolt Cultist in the same hex or adjacent hex to the target. On a roll of 20+ the wound or grievous wound is negated.' }
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return rechargeResult;
      else if (rollResult > 3 && rollResult < 7)
        return holdResult;
      else if (rollResult > 6 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return rechargeResult;
      else if (rollResult > 3 && rollResult < 20)
        return onslaughtResult;
      else
        return furyResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return rechargeResult;
      else if (rollResult > 3 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    }
  };

  //Spindle Drones
  var spindleDroneHostile = {
    name: "Spindle Drone",
    id: "SD",
    size: "SMALL",
    move: 2,
    wounds: 2,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Pulse: Threat Level 0(1)", cols: ["â–¡", "â–¡", "â–¡"] },
        { label: "Pulse: Threat Level 1(1)", cols: ["â–³", "â–³", "â–³"] },
        { label: "Pulse: Threat Level 2(1)", cols: ["â–¡", "â–¡", "â–¡"] },
        { label: "Pulse: Threat Level 3(1)", cols: ["â¬ ", "â¬ ", "â¬ "] },
      ],
      specialRules: [
        { key: 'Spindle Drone Threat Level(1)', value: 'Use the Pulse weapon line on the chart that corresponds to the current threat level.' }
      ]
    },
    specialRules: [
      { key: 'Threat Level', value: 'The threat level for a combat starts at 0. It increases by 1 if an alert result is rolled on the Spindle Drone behaviour table. In addition, each time a Spindle Drone is slain, the threat level increases by 1. Keep track of the current threat level by placing placing a threat level coutner with the number corresponding to the current threat level besides the board. The threat level can never be higher than 3, and drops back to 0 at the end of the combat.' }
    ],
    hiddenResult: function (rollResult) {

      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 7)
        return sneakResult;
      else if (rollResult > 6 && rollResult < 13) {

        if ($("#SDAwakened").is(":checked")) {
          return advanceResult;
        }
        else return sneakResult;

      }
      else if (rollResult > 12 && rollResult < 20) {
        if ($("#SDAwakened").is(":checked")) {
          return scuttleResult;
        }
        else return advanceResult;
      }
      else
        return alertResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7) {
        if ($("#SDAwakened").is(":checked")) {
          return onslaughtResult;
        }
        else return fallbackResult;

      }

      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return alertResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 4)
        return aimResult;
      else if (rollResult > 3 && rollResult < 7)
        return aimResult;
      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return alertResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4) {
        if ($("#SDAwakened").is(":checked")) {
          return aimResult;
        }
        else return fallbackResult;
      }
      else if (rollResult > 3 && rollResult < 7)
        return aimResult;
      else if (rollResult > 6 && rollResult < 10) {
        if ($("#SDAwakened").is(":checked")) {
          return onslaughtResult;
        }
        else return aimResult;
      }
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return alertResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4) {
        if ($("#SDAwakened").is(":checked")) {
          return aimResult;
        }
        else return fallbackResult;
      }
      else if (rollResult > 3 && rollResult < 7)
        return aimResult;
      else if (rollResult > 6 && rollResult < 10) {
        if ($("#SDAwakened").is(":checked")) {
          return onslaughtResult;
        }
        else return aimResult;
      }
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 16)
        return onslaughtResult;
      else if (rollResult > 15 && rollResult < 20) {
        if ($("#SDAwakened").is(":checked")) {
          return onslaughtResult;
        }
        else return advanceResult;
      }
      else
        return alertResult;

    }
  };

  //Guardian Drones
  var guardianDroneHostile = {
    name: "Guardian Drone",
    id: "GD",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 7)
        return hoverdronesResult;
      else if (rollResult > 6 && rollResult < 10)
        return chargeResult;
      else if (rollResult > 9 && rollResult < 20)
        return advanceResult;
      else
        return commandResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 20)
        return onslaughtResult;
      else
        return commandResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 20)
        return onslaughtResult;
      else
        return commandResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 10)
        return chargeResult;
      else if (rollResult > 9 && rollResult < 20)
        return onslaughtResult;
      else
        return commandResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 7)
        return hoverdronesResult;
      else if (rollResult > 6 && rollResult < 10)
        return chargeResult;
      else if (rollResult > 9 && rollResult < 16)
        return advanceResult;
      else if (rollResult > 15 && rollResult < 20)
        return onslaughtResult;
      else
        return commandResult;

    }
  };

  //Ur-Ghuls
  var urGhulHostile = {
    name: "Ur-Ghul",
    id: "UG",
    size: "SMALL",
    move: 3,
    wounds: 3,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Claws & Talons(1)", cols: ["â–³", "-", "-"] }
      ],
      specialRules: [
        { key: 'Frenzied(1)', value: 'When an Ur-Ghul attacks, make three attack rolls. Carry out each attack one at the time, one after the other. The target chosen for the second and third attacks must either be the same target of the previous attack, or in the same hex as or an adjacent hex to the target of the previous attack.' }
      ]
    },
    specialRules: [
      { key: 'Hide in the Shadows', value: 'An Ur-Ghul is treated as being in cover if their attacker is more than 3 hexes from the Ur-Ghul.' }
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10)
        return sneakResult;
      else if (rollResult > 9 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        return pounceResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 20)
        return chargeResult;
      else
        return pounceResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 10)
        return fallbackResult;
      else
        return rushResult;
    }
  };

  //Chaos Beastman
  var chaosBeastmanHostile = {
    name: "Chaos Beastman",
    id: "CB",
    size: "LARGE",
    move: 2,
    wounds: 3,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Pistol & Melee Weapon", cols: ["â¬ ", "â–³", "â–¡"] }
      ],
      specialRules: []
    },
    specialRules: [
      { key: 'Bellowing Beast', value: 'The cost of an action is increased by 1 for explorers who are adjacent to one or more Chaos Beastmen that are visible to them, to a maximum cost of 6+. For example the cost of a (4+) action would be increased to (5+).' },
      { key: 'Furious Charge', value: "Add 1 to a Chaos Beastman's Move value if they are taking a Charge action." }
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10)
        return sneakResult;
      else if (rollResult > 9 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 16)
        return onslaughtResult;
      else
        return furyResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 20)
        return chargeResult;
      else
        return rushResult;
    }
  };

  //Rogue Psyker
  var roguePsykerHostile = {
    name: "Rogue Psyker",
    id: "RP",
    size: "LARGE",
    move: 2,
    wounds: 2,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Chaos Stave(1)", cols: ["â–³/â–³â–³", "â–³/â–³â–³", "â–³/â–³â–³"] }
      ],
      specialRules: [
        { key: 'Empowered(1)', value: 'The action dice for a Chaos Stave attack is doubled if the Rogue Psyker is empowered.' }
      ]
    },
    specialRules: [
      { key: 'Psychic Shield', value: 'Roll the Blackstone dice each time a wound or grievous wound is suffered by a Rogue Psyker. On a 20+, the wound or grievous wound is negated. If the Rogue Psyker is empowered, then the wound or grievous wound is negated on a 16+.' },
      { key: 'Empowered', value: 'Empowered is gained via certain actions. The Rogue Psyker remains empowered until they suffer a wound or grievous wound.' },
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 10)
        return holdResult;
      else if (rollResult > 9 && rollResult < 16)
        return disruptResult;
      else if (rollResult > 15 && rollResult < 20)
        return regenerateResult;
      else
        return empowerResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 16)
        return onslaughtResult;
      else
        return annihilateResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 10)
        return disruptResult;
      else if (rollResult > 9 && rollResult < 16)
        return onslaughtResult;
      else if (rollResult > 15 && rollResult < 20)
        return regenerateResult;
      else
        return empowerResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10)
        return disruptResult;
      else if (rollResult > 9 && rollResult < 16)
        return onslaughtResult;
      else if (rollResult > 15 && rollResult < 20)
        return regenerateResult;
      else
        return empowerResult;
    }
  };

  //Chaos Space Marine
  var chaosSpaceMarineHostile = {
    name: "Chaos Space Marine",
    id: "CSM",
    size: "LARGE",
    move: 2,
    wounds: 4,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Bolter", cols: ["â–³â–³", "â¬ ", "â¬ "] }
      ],
      specialRules: []
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return sneakResult;
      else if (rollResult > 3 && rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 16)
        return chargeResult;
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 16)
        return onslaughtResult;
      else
        return rapidfireResult;
    },
    coverResult: function (rollResult) {
      if (rollResult < 4)
        return aimResult;
      else if (rollResult > 3 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 16)
        return advanceResult;
      else
        return rapidfireResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 7)
        return aimResult;
      else if (rollResult > 6 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 16)
        return advanceResult;
      else
        return rapidfireResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 16)
        return advanceResult;
      else
        return rapidfireResult;
    }
  };

  //Obsidius Mallex
  var obsidiusMallexHostile = {
    name: "Obsidius Mallex",
    id: "OM",
    size: "HUGE",
    move: 2,
    wounds: 12,
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Thunder Hammer(1)", cols: ["â¬ â¬ ", "-", "-"] },
        { label: "Plasma Pistol(2)", cols: ["-", "â¬ ", "â–³"] }
      ],
      specialRules: [
        { key: 'Thunder Hammer(1)', value: 'No defense roll can be made against a Thunder Hammer attack.' },
        { key: 'Plasma Pistol(2)', value: 'No defense roll can be made against an overcharged Plasma Pistol attack.' }
      ]
    },
    specialRules: [
      { key: 'Lord of War', value: 'When Obsidius Mallex is activated, he takes two actions, one after the other. Roll on the behaviour table for his first action, and then take it. Then roll on the behaviour table again for his second action, and then take it.' }
    ],
    hiddenResult: function (rollResult) {
      if (rollResult < 4) {

        if ($("#OMEmpowered").is(":checked")) {
          return advanceResult;
        }
        else return sneakResult;
      }

      else if (rollResult > 3 && rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 13)
        return chargeResult;
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 13)
        return onslaughtResult;
      else
        return furyResult;
    },
    coverResult: function (rollResult) {
      if (rollResult < 7)
        return chargeResult;
      else if (rollResult > 6 && rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 16)
        return onslaughtResult;
      else if (rollResult > 15 && rollResult < 20)
        return overchargeResult;
      else
        return rushResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 7)
        return onslaughtResult;
      else if (rollResult > 6 && rollResult < 16)
        return chargeResult;
      else
        return overchargeResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 7)
        return advanceResult;
      else if (rollResult > 6 && rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 16) {
        if ($("#OMEmpowered").is(":checked")) {
          return chargeResult;
        }
        else return onslaughtResult

      }

      else if (rollResult > 15 && rollResult < 20) {
        if ($("#OMEmpowered").is(":checked")) {
          return rushResult;
        }
        else return overchargeResult;
      }
      else
        return rushResult;
    }
  };

  //Ambull
  var ambullHostile = {
    name: "Ambull",
    id: "AM",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return tunnelResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return onslaughtResult;
      else
        return swipeResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 7)
        return advanceResult;
      else if (rollResult > 6 && rollResult < 18)
        return chargeResult;
      else
        return tunnelResult;
    },

    protectiveResult: function (rollResult) {
      if (rollResult < 18)
        return chargeResult;
      else
        return tunnelResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10) {
        if ($("#AMCheckBox").is(":checked")) {
          return advanceResult;
        }
        else return fallbackResult;
      }

      else if (rollResult > 9 && rollResult < 18)
        return chargeResult;
      else
        return tunnelResult;
    }
  };

  //Borewyrm Infestation
  var borewyrmInfestationHostile = {
    name: "Borewyrm Infestation",
    id: "BI",
    size: "SMALL",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return borewyrmTunnelResult;
      else if (rollResult > 3 && rollResult < 7)
        return holdResult;
      else if (rollResult > 6 && rollResult < 13)
        return sneakResult;
      else if (rollResult > 12 && rollResult < 18)
        return advanceResult;
      else
        return consumeResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return borewyrmTunnelResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return onslaughtResult;
      else
        return consumeResult;
    },
    coverResult: function (rollResult) {
      if (rollResult < 4)
        return borewyrmTunnelResult;
      else if (rollResult > 3 && rollResult < 13)
        return holdResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return consumeResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return borewyrmTunnelResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 18)
        return chargeResult;
      else
        return consumeResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return borewyrmTunnelResult;
      else if (rollResult > 3 && rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 16)
        return chargeResult;
      else
        return consumeResult;
    }
  };

  //Traitor Commissar
  var traitorCommissarHostile = {
    name: "Traitor Commissar",
    id: "TC",
    size: "LARGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 7)
        return holdResult;
      else if (rollResult > 6 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return executeTheWeakResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return onslaughtResult;
      else
        return executeTheWeakResult;
    },
    coverResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return executeTheWeakResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 18)
        return chargeResult;
      else
        return executeTheWeakResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 7)
        return fallbackResult;
      else if (rollResult > 6 && rollResult < 18)
        return chargeResult;
      else
        return executeTheWeakResult;
    }
  };

  //Chaos Ogryn
  var chaosOgrynHostile = {
    name: "Chaos Ogryn",
    id: "CO",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    bodyguardResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 7)
        return advanceResult;
      else if (rollResult > 6 && rollResult < 20)
        return guardResult;
      else
        return crushResult;
    },

    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return sneakResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 20)
        return chargeResult;
      else
        return crushResult;
    },

    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollresult > 12 && rollResult < 20)
        return onslaughtResult;
      else
        crushResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 20)
        return chargeResult;
      else
        return crushResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 20)
        return chargeResult;
      else
        return crushResult;
    }
  };

  //Poxwalker
  var poxwalkerHostile = {
    name: "Poxwalker",
    id: "CO",
    size: "SMALL",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 7)
        return holdResult;
      else if (rollResult > 6 && rollResult < 20)
        return advanceResult;
      else
        return lurchResult;
    },

    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 20)
        return onslaughtResult;
      else
        return virulentBiteResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 16)
        return advanceResult;
      else
        return lurchResult;
    }
  };
  //PLAGUE MARINE
  var plagueMarineHostile = {
    name: "Plague Marine",
    id: "PM",
    size: "LARGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return sneakResult;
      else if (rollResult > 3 && rollResult < 16)
        return advanceResult;
      else
        return steadyAdvanceResult;
    },
    engagedResult: function (rollResult) {
      return onslaughtResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 16)
        return onslaughtResult;
      else
        return plagueAnnihilateResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return aimResult;
      else if (rollResult > 3 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 16)
        return advanceResult;
      else
        return plagueAnnihilateResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return aimResult;
      else if (rollResult > 9 && rollResult < 16)
        return advanceResult;
      else
        return steadyAdvanceResult;
    }


  };

  //MASTER OF POSSESSION
  var masterOfPossessionHostile = {
    name: "Master of Possession",
    id: "MOP",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 20)
        return disruptResult;
      else
        return ritesOfPossessionResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 20)
        return onslaughtResult;
      else
        return warpfireResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 20)
        return advanceResult;
      else
        return chargeResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 16)
        return advanceResult;
      else
        return chargeResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 20)
        return advanceResult;
      else
        return chargeResult;
    }


  };

  //Greater Possessed
  var greaterPossessedHostile = {
    name: "Greater Possessed",
    id: "GP",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return warpsurgeResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult
      else
        return rushResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 19)
        return onslaughtResult;
      else
        return furyResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 2)
        return warpsurgeResult;
      else
        return chargeResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 2)
        return warpsurgeResult;
      else if (rollResult > 1 && rollResult < 19)
        return chargeResult;
      else
        return rushResult;
    }
  };

  //Cultist
  var cultistHostile = {
    name: "Cultists",
    id: "CL",
    size: "SMALL",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return overwhelmResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 18)
        return onslaughtResult
      else
        return fullautoResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return overwhelmResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 18)
        return chargeResult;
      else
        return overwhelmResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return advanceResult;
      else if (rollResult > 9 && rollResult < 18)
        return chargeResult;
      else
        return overwhelmResult;
    }
  };

  //Cultist Firebrand
  var cultistFirebrandHostile = {
    name: "Cultist Firebrand",
    id: "CF",
    size: "LARGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return firestormResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 18)
        return onslaughtResult;
      else
        return allShallBurnResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 19)
        return chargeResult;
      else
        return firestormResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return allShallBurnResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 13)
        return advanceResult;
      else if (rollResult > 12 && rollResult < 18)
        return chargeResult;
      else
        return firestormResult;
    }
  };

  // The Arch***
  var archHostile = {
    name: "The Archivist",
    id: "ARC",
    size: "HUGE",
    move: "??",
    wounds: "??",
    statline2: "",
    statsMatrix: {
      rows: [
        { label: "Example(1)", cols: ["â¬ ", "â¬ ", "-"] }
      ],
      specialRules: [
        { key: 'Example-spec(1)', value: 'Explanation text that goes here.' }
      ]
    },
    hiddenResult: function (rollResult) {
      if (rollResult < 4)
        return holdResult;
      else if (rollResult > 3 && rollResult < 7)
        return sneakResult;
      else if (rollResult > 6 && rollResult < 10)
        return observeResult;
      else if (rollResult > 9 && rollResult < 13)
        return observeResult;
      else
        return advanceResult;
    },
    engagedResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return steadAdvanceResult2;
      else if (rollResult > 6 && rollResult < 16)
        return onslaughtResult;
      else if (rollResult > 15 && rollResult < 18)
        return furyResult;
      else
        return almightyBlowResult;
    },

    coverResult: function (rollResult) {
      if (rollResult < 4)
        return steadAdvanceResult2;
      else if (rollResult > 3 && rollResult < 7)
        return steadAdvanceResult2;
      else if (rollResult > 6 && rollResult < 10)
        return onslaughtResult;
      else if (rollResult > 9 && rollResult < 13)
        return onslaughtResult;
      else if (rollResult > 12 && rollResult < 18)
        return steadAdvanceResult2;
      else
        return furyResult;
    },

    closeResult: function (rollResult) {
      if (rollResult < 4)
        return fallbackResult;
      else if (rollResult > 3 && rollResult < 7)
        return steadAdvanceResult2;
      else if (rollResult > 6 && rollResult < 10)
        return steadAdvanceResult2;
      else if (rollResult > 9 && rollResult < 16)
        return onslaughtResult;
      else
        return chargeResult;
    },

    otherResult: function (rollResult) {
      if (rollResult < 10)
        return observeResult;
      else if (rollResult > 9 && rollResult < 16)
        return advanceResult;
      else
        return steadAdvanceResult2;
    }


  };



  //Default Blackstone dice roll. Takes modifier which can be a number (negative or positive)
  function rollD20(modifier) {
    var result = Math.floor(Math.random() * 20) + 1 + modifier;

    if (result > 20)
      result = 20;
    else if (result < 1)
      result = 1;

    return result;
  }

  function hideAllHostileButtons() {
    $('#TGButton').hide();
    $('#NGButton').hide();
    $('#UGButton').hide();
    $('#SDButton').hide();
    $('#CBButton').hide();
    $('#RPButton').hide();
    $('#CSMButton').hide();
    $('#OMButton').hide();
    $('#OMAButton').hide();
    $('#AMButton').hide();
    $('#AMEButton').hide();
    $('#BIButton').hide();
    $('#TCButton').hide();
    $('#COButton').hide();
    $('#PMButton').hide();
    $('#PWButton').hide();
    $('#GPButton').hide();
    $('#MPButton').hide();
    $('#MOPButton').hide();
    $('#CLButton').hide();
    $('#CFButton').hide();
    $('#GDButton').hide();
    $('#ARCButton').hide();
    //$('#TGCard').hide();

  }

  function showAllHostileButtons() {
    $('#TGButton').show();
    $('#NGButton').show();
    $('#UGButton').show();
    $('#SDButton').show();
    $('#CBButton').show();
    $('#RPButton').show();
    $('#CSMButton').show();
    $('#OMButton').show();
    $('#OMAButton').show();
    $('#AMButton').show();
    $('#AMEButton').show();
    $('#BIButton').show();
    $('#TCButton').show();
    $('#COButton').show();
    $('#PMButton').show();
    $('#PWButton').show();
    $('#GPButton').show();
    $('#MPButton').show();
    $('#MOPButton').show();
    $('#CLButton').show();
    $('#CFButton').show();
    $('#GDButton').show();
  }

  function generateRollResult(modifier, hostileObject, hostileResultObject, hostileDescrObject, hostileStatus) {
    // Add this helper function to look up referenced actions
    function getReferencedAction(desc) {
      if (desc.includes("Onslaught")) return { action: "Onslaught", result: onslaughtResult };
      if (desc.includes("Charge")) return { action: "Charge", result: chargeResult };
      // Add other action lookups as needed
      return null;
    }

    var d20Roll = rollD20(modifier);
    var rollResult;

    // Get the appropriate result based on status
    switch (hostileStatus) {
      case "ENGAGED": rollResult = hostileObject.engagedResult(d20Roll); break;
      case "HIDDEN": rollResult = hostileObject.hiddenResult(d20Roll); break;
      case "OTHER": rollResult = hostileObject.otherResult(d20Roll); break;
      case "COVER": rollResult = hostileObject.coverResult(d20Roll); break;
      case "CLOSE": rollResult = hostileObject.closeResult(d20Roll); break;
      case "PROTECTIVE": rollResult = hostileObject.protectiveResult(d20Roll); break;
      case "BODYGUARD": rollResult = hostileObject.bodyguardResult(d20Roll); break;
      default: return;
    }

    // Show the roll result
    hostileResultObject.text(d20Roll + " - " + rollResult.result);

    // Get referenced action if any
    var referencedAction = getReferencedAction(rollResult.descr);

    // Build the full description
    if (referencedAction) {
      note = '<strong>' + referencedAction.action + '</strong>: ' + referencedAction.result.descr;  // Add action name, then use the referenced action's description as the note
    } else if (rollResult.note) {
      note = rollResult.note; // Otherwise use any existing note
    } else {
      note = "";
    }

    // Show the description and note
    if (note) {
      hostileDescrObject.html(rollResult.descr + '<br><i class="text-muted small">' + note + '</i>');
    } else {
      hostileDescrObject.text(rollResult.descr);
    }

  }

  $(document).ready(
    function () {
      hideAllHostileButtons();

      $('#generateHostileButton').click(
        function () {
          showAllHostileButtons();
          showHostile++;
          if (showHostile == 5) {
            alert("You have unlocked the Archivist!!!");
            $('#multiHostileSelect').append('<option value="ARC">The Archivist</option>');
          }
        }
      )

      $('#multiHostileSelect').change(
        function () {

          $('select > option:selected').each(function () {
            // alert($(this).val());
            if ($(this).val() == 'TG')
              $('#TGButton').show();
            if ($(this).val() == 'NG')
              $('#NGButton').show();
            if ($(this).val() == 'UG')
              $('#UGButton').show();
            if ($(this).val() == 'SD')
              $('#SDButton').show();
            if ($(this).val() == 'CB')
              $('#CBButton').show();
            if ($(this).val() == 'RP')
              $('#RPButton').show();
            if ($(this).val() == 'CSM')
              $('#CSMButton').show();
            if ($(this).val() == 'OM')
              $('#OMButton').show();
            if ($(this).val() == 'OMA')
              $('#OMAButton').show();
            if ($(this).val() == 'AM')
              $('#AMButton').show();
            if ($(this).val() == 'AME')
              $('#AMEButton').show();
            if ($(this).val() == 'BI')
              $('#BIButton').show();
            if ($(this).val() == 'TC')
              $('#TCButton').show();
            if ($(this).val() == 'CO')
              $('#COButton').show();
            if ($(this).val() == 'PM')
              $('#PMButton').show();
            if ($(this).val() == 'PW')
              $('#PWButton').show();
            if ($(this).val() == 'GP')
              $('#GPButton').show();
            if ($(this).val() == 'MOP')
              $('#MOPButton').show();
            if ($(this).val() == 'CL')
              $('#CLButton').show();
            if ($(this).val() == 'CF')
              $('#CFButton').show();
            if ($(this).val() == 'GD')
              $('#GDButton').show();
            if ($(this).val() == 'ARC')
              $('#ARCButton').show();

          });

          $('select > option:not(:selected)').each(function () {
            // alert($(this).val());
            if ($(this).val() == 'TG') {
              $('#TGButton').hide();
            }
            if ($(this).val() == 'NG')
              $('#NGButton').hide();
            if ($(this).val() == 'UG')
              $('#UGButton').hide();
            if ($(this).val() == 'SD')
              $('#SDButton').hide();
            if ($(this).val() == 'CB')
              $('#CBButton').hide();
            if ($(this).val() == 'RP')
              $('#RPButton').hide();
            if ($(this).val() == 'CSM')
              $('#CSMButton').hide();
            if ($(this).val() == 'OM')
              $('#OMButton').hide();
            if ($(this).val() == 'OMA')
              $('#OMAButton').hide();
            if ($(this).val() == 'AM')
              $('#AMButton').hide();
            if ($(this).val() == 'AME')
              $('#AMEButton').hide();
            if ($(this).val() == 'BI')
              $('#BIButton').hide();
            if ($(this).val() == 'TC')
              $('#TCButton').hide();
            if ($(this).val() == 'CO')
              $('#COButton').hide();
            if ($(this).val() == 'PM')
              $('#PMButton').hide();
            if ($(this).val() == 'PW')
              $('#PWButton').hide();
            if ($(this).val() == 'GP')
              $('#GPButton').hide();
            if ($(this).val() == 'MOP')
              $('#MOPButton').hide();
            if ($(this).val() == 'CL')
              $('#CLButton').hide();
            if ($(this).val() == 'CF')
              $('#CFButton').hide();
            if ($(this).val() == 'GD')
              $('#GDButton').hide();

            if ($(this).val() == 'ARC')
              $('#ARCButton').hide();

          });



        }
      )

      //GUARDSMEN
      $('#TGMoveStats').text(traitorGuardHostile.move);
      $('#TGWoundStats').text(traitorGuardHostile.wounds);
      if (traitorGuardHostile.statline2) {
        $('#TGStatline2').text(traitorGuardHostile.statline2);
      }
      populateStatsMatrix(traitorGuardHostile);
      populateSpecialRules(traitorGuardHostile);

      $('#TGHiddenButton').click(

        function () {

          if ($("#TGCheckBox").is(":checked")) {
            generateRollResult(2, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "HIDDEN");
          }
          else
            generateRollResult(0, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "HIDDEN");
        }
      )
      $('#TGEngagedButton').click(

        function () {
          if ($("#TGCheckBox").is(":checked"))
            generateRollResult(2, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "ENGAGED");
          else
            generateRollResult(0, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "ENGAGED");
        }
      )
      $('#TGCoverButton').click(

        function () {
          // var d20Roll = rollD20(modifier);
          // var rollResult = traitorGuardHostile.coverResult(d20Roll);
          // $('#TGResultValue').text(d20Roll+" - "+rollResult.result);
          // $('#TGResultDescr').text(rollResult.descr);

          if ($("#TGCheckBox").is(":checked"))
            generateRollResult(2, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "COVER");
          else
            generateRollResult(0, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "COVER");

        }
      )
      $('#TGCloseButton').click(

        function () {
          // var d20Roll = rollD20(modifier);
          // var rollResult = traitorGuardHostile.closeResult(d20Roll);
          // $('#TGResultValue').text(d20Roll+" - "+rollResult.result);
          // $('#TGResultDescr').text(rollResult.descr);

          if ($("#TGCheckBox").is(":checked"))
            generateRollResult(2, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "CLOSE");
          else
            generateRollResult(0, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "CLOSE");
        }
      )
      $('#TGOtherButton').click(

        function () {
          // var d20Roll = rollD20(modifier);
          // var rollResult = traitorGuardHostile.otherResult(d20Roll);
          // $('#TGResultValue').text(d20Roll+" - "+rollResult.result);
          // $('#TGResultDescr').text(rollResult.descr);

          if ($("#TGCheckBox").is(":checked"))
            generateRollResult(2, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "OTHER");
          else
            generateRollResult(0, traitorGuardHostile, $('#TGResultValue'), $('#TGResultDescr'), "OTHER");
        }
      )

      $('#TGCard').on('hidden.bs.collapse', function () {
        $('#TGResultValue').text("");
        $('#TGResultDescr').text("");
        $('#TGCheckBox').prop("checked", false);
      })

      //NEGAVOLT
      $('#NGMoveStats').text(negavoltCultistHostile.move);
      $('#NGWoundStats').text(negavoltCultistHostile.wounds);
      if (negavoltCultistHostile.statline2) {
        $('#NGStatline2').text(negavoltCultistHostile.statline2);
      }
      populateStatsMatrix(negavoltCultistHostile);
      populateSpecialRules(negavoltCultistHostile);


      $('#NGHiddenButton').click(

        function () {
          generateRollResult(0, negavoltCultistHostile, $('#NGResultValue'), $('#NGResultDescr'), "HIDDEN");
        }
      )

      $('#NGEngagedButton').click(

        function () {
          generateRollResult(0, negavoltCultistHostile, $('#NGResultValue'), $('#NGResultDescr'), "ENGAGED");
        }
      )
      $('#NGOtherButton').click(

        function () {
          generateRollResult(0, negavoltCultistHostile, $('#NGResultValue'), $('#NGResultDescr'), "OTHER");
        }
      )

      $('#NGCard').on('hidden.bs.collapse', function () {
        $('#NGResultValue').text("");
        $('#NGResultDescr').text("");
      })


      //Spindle Drones
      $('#SDMoveStats').text(spindleDroneHostile.move);
      $('#SDWoundStats').text(spindleDroneHostile.wounds);
      if (spindleDroneHostile.statline2) {
        $('#SDStatline2').text(spindleDroneHostile.statline2);
      }
      populateStatsMatrix(spindleDroneHostile);
      populateSpecialRules(spindleDroneHostile);

      $('#SDHiddenButton').click(

        //if($("input:checked").val()=='TG')
        //  generateRollResult(2, traitorGuardHostile,$('#TGResultValue'),$('#TGResultDescr'),"ENGAGED");
        //  else
        //  generateRollResult(0, traitorGuardHostile,$('#TGResultValue'),$('#TGResultDescr'),"ENGAGED");


        function () {
          if ($("#enhancedAISD").is(":checked"))
            generateRollResult(1, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "HIDDEN");
          else
            generateRollResult(0, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "HIDDEN");

        }
      )

      $('#SDEngagedButton').click(

        function () {
          if ($("#enhancedAISD").is(":checked"))
            generateRollResult(1, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "ENGAGED");
          else
            generateRollResult(0, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "ENGAGED");

        }
      )

      $('#SDCoverButton').click(

        function () {
          if ($("#enhancedAISD").is(":checked"))
            generateRollResult(1, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "COVER");
          else
            generateRollResult(0, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "COVER");

        }
      )

      $('#SDCloseButton').click(

        function () {
          if ($("#enhancedAISD").is(":checked"))
            generateRollResult(1, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "CLOSE");
          else
            generateRollResult(0, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "CLOSE");

        }
      )

      $('#SDOtherButton').click(

        function () {
          if ($("#enhancedAISD").is(":checked"))
            generateRollResult(1, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "OTHER");
          else
            generateRollResult(0, spindleDroneHostile, $('#SDResultValue'), $('#SDResultDescr'), "OTHER");

        }
      )

      $('#SDCard').on('hidden.bs.collapse', function () {
        $('#SDResultValue').text("");
        $('#SDResultDescr').text("");
        $('#enhancedAISD').prop("checked", false);
      })

      //Guardian Drone
      $('#GDMoveStats').text(guardianDroneHostile.move);
      $('#GDWoundStats').text(guardianDroneHostile.wounds);
      if (guardianDroneHostile.statline2) {
        $('#GDStatline2').text(guardianDroneHostile.statline2);
      }
      populateStatsMatrix(guardianDroneHostile);
      populateSpecialRules(guardianDroneHostile);

      $('#GDHiddenButton').click(

        function () {
          generateRollResult(0, guardianDroneHostile, $('#GDResultValue'), $('#GDResultDescr'), "HIDDEN");
        }
      )

      $('#GDEngagedButton').click(

        function () {
          generateRollResult(0, guardianDroneHostile, $('#GDResultValue'), $('#GDResultDescr'), "ENGAGED");
        }
      )

      $('#GDCoverButton').click(

        function () {
          generateRollResult(0, guardianDroneHostile, $('#GDResultValue'), $('#GDResultDescr'), "COVER");
        }
      )

      $('#GDCloseButton').click(

        function () {
          generateRollResult(0, guardianDroneHostile, $('#GDResultValue'), $('#GDResultDescr'), "CLOSE");
        }
      )

      $('#GDOtherButton').click(

        function () {
          generateRollResult(0, guardianDroneHostile, $('#GDResultValue'), $('#GDResultDescr'), "OTHER");
        }
      )

      $('#GDCard').on('hidden.bs.collapse', function () {
        $('#GDResultValue').text("");
        $('#GDResultDescr').text("");
        $('#enhancedAIGD').prop("checked", false);
      })

      //Ur-Ghuls
      $('#UGMoveStats').text(urGhulHostile.move);
      $('#UGWoundStats').text(urGhulHostile.wounds);
      if (urGhulHostile.statline2) {
        $('#UGStatline2').text(urGhulHostile.statline2);
      }
      populateStatsMatrix(urGhulHostile);
      populateSpecialRules(urGhulHostile);

      $('#UGHiddenButton').click(

        function () {
          generateRollResult(0, urGhulHostile, $('#UGResultValue'), $('#UGResultDescr'), "HIDDEN");
        }
      )

      $('#UGEngagedButton').click(

        function () {
          generateRollResult(0, urGhulHostile, $('#UGResultValue'), $('#UGResultDescr'), "ENGAGED");
        }
      )

      $('#UGCloseButton').click(

        function () {
          generateRollResult(0, urGhulHostile, $('#UGResultValue'), $('#UGResultDescr'), "CLOSE");
        }
      )

      $('#UGOtherButton').click(

        function () {
          generateRollResult(0, urGhulHostile, $('#UGResultValue'), $('#UGResultDescr'), "OTHER");
        }
      )

      $('#UGCard').on('hidden.bs.collapse', function () {
        $('#UGResultValue').text("");
        $('#UGResultDescr').text("");
      })

      //Chaos Beastman
      $('#CBMoveStats').text(chaosBeastmanHostile.move);
      $('#CBWoundStats').text(chaosBeastmanHostile.wounds);
      if (chaosBeastmanHostile.statline2) {
        $('#CBStatline2').text(chaosBeastmanHostile.statline2);
      }
      populateStatsMatrix(chaosBeastmanHostile);
      populateSpecialRules(chaosBeastmanHostile);

      $('#CBHiddenButton').click(

        function () {
          generateRollResult(0, chaosBeastmanHostile, $('#CBResultValue'), $('#CBResultDescr'), "HIDDEN");
        }
      )

      $('#CBEngagedButton').click(

        function () {
          generateRollResult(0, chaosBeastmanHostile, $('#CBResultValue'), $('#CBResultDescr'), "ENGAGED");
        }
      )

      $('#CBCloseButton').click(

        function () {
          generateRollResult(0, chaosBeastmanHostile, $('#CBResultValue'), $('#CBResultDescr'), "CLOSE");
        }
      )

      $('#CBOtherButton').click(

        function () {
          generateRollResult(0, chaosBeastmanHostile, $('#CBResultValue'), $('#CBResultDescr'), "OTHER");
        }
      )

      $('#CBCard').on('hidden.bs.collapse', function () {
        $('#CBResultValue').text("");
        $('#CBResultDescr').text("");
      })

      //Rogue Psyker
      $('#RPMoveStats').text(roguePsykerHostile.move);
      $('#RPWoundStats').text(roguePsykerHostile.wounds);
      if (roguePsykerHostile.statline2) {
        $('#RPStatline2').text(roguePsykerHostile.statline2);
      }
      populateStatsMatrix(roguePsykerHostile);
      populateSpecialRules(roguePsykerHostile);

      $('#RPHiddenButton').click(

        function () {
          generateRollResult(0, roguePsykerHostile, $('#RPResultValue'), $('#RPResultDescr'), "HIDDEN");
        }
      )

      $('#RPEngagedButton').click(

        function () {
          generateRollResult(0, roguePsykerHostile, $('#RPResultValue'), $('#RPResultDescr'), "ENGAGED");
        }
      )

      $('#RPCloseButton').click(

        function () {
          generateRollResult(0, roguePsykerHostile, $('#RPResultValue'), $('#RPResultDescr'), "CLOSE");
        }
      )

      $('#RPOtherButton').click(

        function () {
          generateRollResult(0, roguePsykerHostile, $('#RPResultValue'), $('#RPResultDescr'), "OTHER");
        }
      )

      $('#RPCard').on('hidden.bs.collapse', function () {
        $('#RPResultValue').text("");
        $('#RPResultDescr').text("");
      })

      //Chaos Space Marines
      $('#CSMMoveStats').text(chaosSpaceMarineHostile.move);
      $('#CSMWoundStats').text(chaosSpaceMarineHostile.wounds);
      if (chaosSpaceMarineHostile.statline2) {
        $('#CSMStatline2').text(chaosSpaceMarineHostile.statline2);
      }
      populateStatsMatrix(chaosSpaceMarineHostile);
      populateSpecialRules(chaosSpaceMarineHostile);

      $('#CSMHiddenButton').click(

        function () {
          generateRollResult(0, chaosSpaceMarineHostile, $('#CSMResultValue'), $('#CSMResultDescr'), "HIDDEN");
        }
      )

      $('#CSMEngagedButton').click(

        function () {
          generateRollResult(0, chaosSpaceMarineHostile, $('#CSMResultValue'), $('#CSMResultDescr'), "ENGAGED");
        }
      )

      $('#CSMCoverButton').click(

        function () {
          generateRollResult(0, chaosSpaceMarineHostile, $('#CSMResultValue'), $('#CSMResultDescr'), "COVER");
        }
      )

      $('#CSMCloseButton').click(

        function () {
          generateRollResult(0, chaosSpaceMarineHostile, $('#CSMResultValue'), $('#CSMResultDescr'), "CLOSE");
        }
      )

      $('#CSMOtherButton').click(

        function () {
          generateRollResult(0, chaosSpaceMarineHostile, $('#CSMResultValue'), $('#CSMResultDescr'), "OTHER");
        }
      )

      $('#CSMCard').on('hidden.bs.collapse', function () {
        $('#CSMResultValue').text("");
        $('#CSMResultDescr').text("");
      })

      //Obsidius Mallex
      $('#OMMoveStats').text(obsidiusMallexHostile.move);
      $('#OMWoundStats').text(obsidiusMallexHostile.wounds);
      if (obsidiusMallexHostile.statline2) {
        $('#OMStatline2').text(obsidiusMallexHostile.statline2);
      }
      populateStatsMatrix(obsidiusMallexHostile);
      populateSpecialRules(obsidiusMallexHostile);

      $('#OMHiddenButton').click(

        function () {
          generateRollResult(0, obsidiusMallexHostile, $('#OMResultValue'), $('#OMResultDescr'), "HIDDEN");
        }
      )

      $('#OMEngagedButton').click(

        function () {
          generateRollResult(0, obsidiusMallexHostile, $('#OMResultValue'), $('#OMResultDescr'), "ENGAGED");
        }
      )

      $('#OMCoverButton').click(

        function () {
          generateRollResult(0, obsidiusMallexHostile, $('#OMResultValue'), $('#OMResultDescr'), "COVER");
        }
      )

      $('#OMCloseButton').click(

        function () {
          generateRollResult(0, obsidiusMallexHostile, $('#OMResultValue'), $('#OMResultDescr'), "CLOSE");
        }
      )

      $('#OMOtherButton').click(

        function () {
          generateRollResult(0, obsidiusMallexHostile, $('#OMResultValue'), $('#OMResultDescr'), "OTHER");
        }
      )

      $('#OMCard').on('hidden.bs.collapse', function () {
        $('#OMResultValue').text("");
        $('#OMResultDescr').text("");
      })


      //Ambull
      $('#AMMoveStats').text(ambullHostile.move);
      $('#AMWoundStats').text(ambullHostile.wounds);
      if (ambullHostile.statline2) {
        $('#AMStatline2').text(ambullHostile.statline2);
      }
      populateStatsMatrix(ambullHostile);
      populateSpecialRules(ambullHostile);

      $('#AMHiddenButton').click(

        function () {
          generateRollResult(0, ambullHostile, $('#AMResultValue'), $('#AMResultDescr'), "HIDDEN");
        }
      )

      $('#AMEngagedButton').click(

        function () {
          generateRollResult(0, ambullHostile, $('#AMResultValue'), $('#AMResultDescr'), "ENGAGED");
        }
      )

      $('#AMProtectiveButton').click(

        function () {
          generateRollResult(0, ambullHostile, $('#AMResultValue'), $('#AMResultDescr'), "PROTECTIVE");
        }
      )

      $('#AMCloseButton').click(

        function () {
          generateRollResult(0, ambullHostile, $('#AMResultValue'), $('#AMResultDescr'), "CLOSE");
        }
      )

      $('#AMOtherButton').click(

        function () {
          generateRollResult(0, ambullHostile, $('#AMResultValue'), $('#AMResultDescr'), "OTHER");
        }
      )

      $('#AMCard').on('hidden.bs.collapse', function () {
        $('#AMResultValue').text("");
        $('#AMResultDescr').text("");
      })

      //Borewyrm Infestation
      $('#BIMoveStats').text(borewyrmInfestationHostile.move);
      $('#BIWoundStats').text(borewyrmInfestationHostile.wounds);
      if (borewyrmInfestationHostile.statline2) {
        $('#BIStatline2').text(borewyrmInfestationHostile.statline2);
      }
      populateStatsMatrix(borewyrmInfestationHostile);
      populateSpecialRules(borewyrmInfestationHostile);

      $('#BIHiddenButton').click(

        function () {
          generateRollResult(0, borewyrmInfestationHostile, $('#BIResultValue'), $('#BIResultDescr'), "HIDDEN");
        }
      )

      $('#BIEngagedButton').click(

        function () {
          generateRollResult(0, borewyrmInfestationHostile, $('#BIResultValue'), $('#BIResultDescr'), "ENGAGED");
        }
      )

      $('#BICoverButton').click(

        function () {
          generateRollResult(0, borewyrmInfestationHostile, $('#BIResultValue'), $('#BIResultDescr'), "COVER");
        }
      )

      $('#BICloseButton').click(

        function () {
          generateRollResult(0, borewyrmInfestationHostile, $('#BIResultValue'), $('#BIResultDescr'), "CLOSE");
        }
      )

      $('#BIOtherButton').click(

        function () {
          generateRollResult(0, borewyrmInfestationHostile, $('#BIResultValue'), $('#BIResultDescr'), "OTHER");
        }
      )

      $('#BICard').on('hidden.bs.collapse', function () {
        $('#BIResultValue').text("");
        $('#BIResultDescr').text("");
      })

      //Traitor Commissar
      $('#TCMoveStats').text(traitorCommissarHostile.move);
      $('#TCWoundStats').text(traitorCommissarHostile.wounds);
      if (traitorCommissarHostile.statline2) {
        $('#TCStatline2').text(traitorCommissarHostile.statline2);
      }
      populateStatsMatrix(traitorCommissarHostile);
      populateSpecialRules(traitorCommissarHostile);


      $('#TCHiddenButton').click(

        function () {
          generateRollResult(0, traitorCommissarHostile, $('#TCResultValue'), $('#TCResultDescr'), "HIDDEN");
        }
      )

      $('#TCEngagedButton').click(

        function () {
          generateRollResult(0, traitorCommissarHostile, $('#TCResultValue'), $('#TCResultDescr'), "ENGAGED");
        }
      )

      $('#TCCoverButton').click(

        function () {
          generateRollResult(0, traitorCommissarHostile, $('#TCResultValue'), $('#TCResultDescr'), "COVER");
        }
      )

      $('#TCCloseButton').click(

        function () {
          generateRollResult(0, traitorCommissarHostile, $('#TCResultValue'), $('#TCResultDescr'), "CLOSE");
        }
      )

      $('#TCOtherButton').click(

        function () {
          generateRollResult(0, traitorCommissarHostile, $('#TCResultValue'), $('#TCResultDescr'), "OTHER");
        }
      )

      $('#TCCard').on('hidden.bs.collapse', function () {
        $('#TCResultValue').text("");
        $('#TCResultDescr').text("");
      })

      //Chaos Ogryn
      $('#COMoveStats').text(chaosOgrynHostile.move);
      $('#COWoundStats').text(chaosOgrynHostile.wounds);
      if (chaosOgrynHostile.statline2) {
        $('#COStatline2').text(chaosOgrynHostile.statline2);
      }
      populateStatsMatrix(chaosOgrynHostile);
      populateSpecialRules(chaosOgrynHostile);

      $('#COHiddenButton').click(

        function () {
          generateRollResult(0, chaosOgrynHostile, $('#COResultValue'), $('#COResultDescr'), "HIDDEN");
        }
      )

      $('#COEngagedButton').click(

        function () {
          generateRollResult(0, chaosOgrynHostile, $('#COResultValue'), $('#COResultDescr'), "ENGAGED");
        }
      )

      $('#COBodyguardButton').click(

        function () {
          generateRollResult(0, chaosOgrynHostile, $('#COResultValue'), $('#COResultDescr'), "BODYGUARD");
        }
      )

      $('#COCloseButton').click(

        function () {
          generateRollResult(0, chaosOgrynHostile, $('#COResultValue'), $('#COResultDescr'), "CLOSE");
        }
      )

      $('#COOtherButton').click(

        function () {
          generateRollResult(0, chaosOgrynHostile, $('#COResultValue'), $('#COResultDescr'), "OTHER");
        }
      )

      $('#COCard').on('hidden.bs.collapse', function () {
        $('#COResultValue').text("");
        $('#COResultDescr').text("");
      })

      //Poxwalker
      $('#PWMoveStats').text(poxwalkerHostile.move);
      $('#PWWoundStats').text(poxwalkerHostile.wounds);
      if (poxwalkerHostile.statline2) {
        $('#PWStatline2').text(poxwalkerHostile.statline2);
      }
      populateStatsMatrix(poxwalkerHostile);
      populateSpecialRules(poxwalkerHostile);

      $('#PWHiddenButton').click(

        function () {
          generateRollResult(0, poxwalkerHostile, $('#PWResultValue'), $('#PWResultDescr'), "HIDDEN");
        }
      )

      $('#PWEngagedButton').click(

        function () {
          generateRollResult(0, poxwalkerHostile, $('#PWResultValue'), $('#PWResultDescr'), "ENGAGED");
        }
      )

      $('#PWOtherButton').click(

        function () {
          generateRollResult(0, poxwalkerHostile, $('#PWResultValue'), $('#PWResultDescr'), "OTHER");
        }
      )

      $('#PWCard').on('hidden.bs.collapse', function () {
        $('#PWResultValue').text("");
        $('#PWResultDescr').text("");
      })

      //Plague Marines
      $('#PMMoveStats').text(plagueMarineHostile.move);
      $('#PMWoundStats').text(plagueMarineHostile.wounds);
      if (plagueMarineHostile.statline2) {
        $('#PMStatline2').text(plagueMarineHostile.statline2);
      }
      populateStatsMatrix(plagueMarineHostile);
      populateSpecialRules(plagueMarineHostile);

      $('#PMHiddenButton').click(

        function () {
          generateRollResult(0, plagueMarineHostile, $('#PMResultValue'), $('#PMResultDescr'), "HIDDEN");
        }
      )

      $('#PMEngagedButton').click(

        function () {
          generateRollResult(0, plagueMarineHostile, $('#PMResultValue'), $('#PMResultDescr'), "ENGAGED");
        }
      )

      $('#PMCoverButton').click(

        function () {
          generateRollResult(0, plagueMarineHostile, $('#PMResultValue'), $('#PMResultDescr'), "COVER");
        }
      )

      $('#PMCloseButton').click(

        function () {
          generateRollResult(0, plagueMarineHostile, $('#PMResultValue'), $('#PMResultDescr'), "CLOSE");
        }
      )

      $('#PMOtherButton').click(

        function () {
          generateRollResult(0, plagueMarineHostile, $('#PMResultValue'), $('#PMResultDescr'), "OTHER");
        }
      )

      $('#PMCard').on('hidden.bs.collapse', function () {
        $('#PMResultValue').text("");
        $('#PMResultDescr').text("");
      })

      //Master of Possession
      $('#MOPMoveStats').text(masterOfPossessionHostile.move);
      $('#MOPWoundStats').text(masterOfPossessionHostile.wounds);
      if (masterOfPossessionHostile.statline2) {
        $('#MOPStatline2').text(masterOfPossessionHostile.statline2);
      }
      populateStatsMatrix(masterOfPossessionHostile);
      populateSpecialRules(masterOfPossessionHostile);

      $('#MOPHiddenButton').click(

        function () {
          generateRollResult(0, masterOfPossessionHostile, $('#MOPResultValue'), $('#MOPResultDescr'), "HIDDEN");
        }
      )

      $('#MOPEngagedButton').click(

        function () {
          generateRollResult(0, masterOfPossessionHostile, $('#MOPResultValue'), $('#MOPResultDescr'), "ENGAGED");
        }
      )

      $('#MOPCoverButton').click(

        function () {
          generateRollResult(0, masterOfPossessionHostile, $('#MOPResultValue'), $('#MOPResultDescr'), "COVER");
        }
      )

      $('#MOPCloseButton').click(

        function () {
          generateRollResult(0, masterOfPossessionHostile, $('#MOPResultValue'), $('#MOPResultDescr'), "CLOSE");
        }
      )

      $('#MOPOtherButton').click(

        function () {
          generateRollResult(0, masterOfPossessionHostile, $('#MOPResultValue'), $('#MOPResultDescr'), "OTHER");
        }
      )

      $('#MOPCard').on('hidden.bs.collapse', function () {
        $('#MOPResultValue').text("");
        $('#MOPResultDescr').text("");
      })

      //GREATER POSSESSED
      $('#GPMoveStats').text(greaterPossessedHostile.move);
      $('#GPWoundStats').text(greaterPossessedHostile.wounds);
      if (greaterPossessedHostile.statline2) {
        $('#GPStatline2').text(greaterPossessedHostile.statline2);
      }
      populateStatsMatrix(greaterPossessedHostile);
      populateSpecialRules(greaterPossessedHostile);

      $('#GPHiddenButton').click(

        function () {
          generateRollResult(0, greaterPossessedHostile, $('#GPResultValue'), $('#GPResultDescr'), "HIDDEN");
        }
      )

      $('#GPEngagedButton').click(

        function () {
          generateRollResult(0, greaterPossessedHostile, $('#GPResultValue'), $('#GPResultDescr'), "ENGAGED");
        }
      )

      $('#GPCloseButton').click(

        function () {
          generateRollResult(0, greaterPossessedHostile, $('#GPResultValue'), $('#GPResultDescr'), "CLOSE");
        }
      )

      $('#GPOtherButton').click(

        function () {
          generateRollResult(0, greaterPossessedHostile, $('#GPResultValue'), $('#GPResultDescr'), "OTHER");
        }
      )

      $('#GPCard').on('hidden.bs.collapse', function () {
        $('#GPResultValue').text("");
        $('#GPResultDescr').text("");
      })

      //Cultists
      $('#CLMoveStats').text(cultistHostile.move);
      $('#CLWoundStats').text(cultistHostile.wounds);
      if (cultistHostile.statline2) {
        $('#CLStatline2').text(cultistHostile.statline2);
      }
      populateStatsMatrix(cultistHostile);
      populateSpecialRules(cultistHostile);

      $('#CLHiddenButton').click(

        function () {

          if ($("#CLCheckBox").is(":checked"))
            generateRollResult(2, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "HIDDEN");
          else
            generateRollResult(0, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "HIDDEN");
        }
      )

      $('#CLEngagedButton').click(

        function () {
          if ($("#CLCheckBox").is(":checked"))
            generateRollResult(2, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "ENGAGED");
          else
            generateRollResult(0, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "ENGAGED");
        }
      )

      $('#CLCoverButton').click(

        function () {
          if ($("#CLCheckBox").is(":checked"))
            generateRollResult(2, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "COVER");
          else
            generateRollResult(0, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "COVER");
        }
      )

      $('#CLCloseButton').click(

        function () {
          if ($("#CLCheckBox").is(":checked"))
            generateRollResult(2, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "CLOSE");
          else
            generateRollResult(0, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "CLOSE");
        }
      )

      $('#CLOtherButton').click(

        function () {
          if ($("#CLCheckBox").is(":checked"))
            generateRollResult(2, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "OTHER");
          else
            generateRollResult(0, cultistHostile, $('#CLResultValue'), $('#CLResultDescr'), "OTHER");
        }
      )

      $('#CLCard').on('hidden.bs.collapse', function () {
        $('#CLResultValue').text("");
        $('#CLResultDescr').text("");
        $('#CLCheckBox').prop("checked", false);
      })

      //Cultist Firebrand
      $('#CFMoveStats').text(cultistFirebrandHostile.move);
      $('#CFWoundStats').text(cultistFirebrandHostile.wounds);
      if (cultistFirebrandHostile.statline2) {
        $('#CFStatline2').text(cultistFirebrandHostile.statline2);
      }
      populateStatsMatrix(cultistFirebrandHostile);
      populateSpecialRules(cultistFirebrandHostile);

      $('#CFHiddenButton').click(

        function () {
          generateRollResult(0, cultistFirebrandHostile, $('#CFResultValue'), $('#CFResultDescr'), "HIDDEN");
        }
      )

      $('#CFEngagedButton').click(

        function () {
          generateRollResult(0, cultistFirebrandHostile, $('#CFResultValue'), $('#CFResultDescr'), "ENGAGED");
        }
      )

      $('#CFCoverButton').click(

        function () {
          generateRollResult(0, cultistFirebrandHostile, $('#CFResultValue'), $('#CFResultDescr'), "COVER");
        }
      )

      $('#CFCloseButton').click(

        function () {
          generateRollResult(0, cultistFirebrandHostile, $('#CFResultValue'), $('#CFResultDescr'), "CLOSE");
        }
      )

      $('#CFOtherButton').click(

        function () {
          generateRollResult(0, cultistFirebrandHostile, $('#CFResultValue'), $('#CFResultDescr'), "OTHER");
        }
      )

      $('#CFCard').on('hidden.bs.collapse', function () {
        $('#CFResultValue').text("");
        $('#CFResultDescr').text("");
      })

      // The ARCH***
      $('#ARCMoveStats').text(archHostile.move);
      $('#ARCWoundStats').text(archHostile.wounds);
      if (archHostile.statline2) {
        $('#ARCStatline2').text(archHostile.statline2);
      }
      populateStatsMatrix(archHostile);
      populateSpecialRules(archHostile);

      $('#ARCHiddenButton').click(

        function () {
          generateRollResult(0, archHostile, $('#ARCResultValue'), $('#ARCResultDescr'), "HIDDEN");
        }
      )
      $('#ARCEngagedButton').click(

        function () {
          generateRollResult(0, archHostile, $('#ARCResultValue'), $('#ARCResultDescr'), "ENGAGED");
        }
      )

      $('#ARCCoverButton').click(

        function () {

          generateRollResult(0, traitorGuardHostile, $('#ARCResultValue'), $('#ARCResultDescr'), "COVER");

        }
      )
      $('#ARCCloseButton').click(

        function () {
          generateRollResult(0, traitorGuardHostile, $('#ARCResultValue'), $('#ARCResultDescr'), "CLOSE");
        }
      )
      $('#ARCOtherButton').click(

        function () {
          generateRollResult(0, traitorGuardHostile, $('#ARCResultValue'), $('#ARCResultDescr'), "OTHER");
        }
      )

      $('#ARCCard').on('hidden.bs.collapse', function () {
        $('#ARCResultValue').text("");
        $('#ARCResultDescr').text("");
        $('#ARCCheckBox').prop("checked", false);
      })





      $('#resetHostilesButton').click(

        function () {
          location.reload();
        }
      )

      $('#blackstoneRoll').click(
        function () {
          $('#blackstoneDiceResult').text(rollD20(0));
        }

      )

      $('#clearHostileListButon').click(
        function () {
          hideAllHostileButtons();
          $('#multiHostileSelect').val([]);
        }

      )
      //On click event roll the dice and apply the result
      $('#eventButton').click(
        function () {
          //generateEventResult(0, $('#eventTitleDescr'), $('#eventDetailDescr'))
          generateEventResultV2(0, $('#multiEventSelect').val(), $('#eventTitleDescr'), $('#eventDetailDescr'));
        }

      )

      function reinforce(modifier) {
        var result = rollD20(modifier);
        var resultText;
        if (result == 3) {
          resultText = "ROLL:" + result + "|SMALL-2|LARGE-0|HUGE-0|";
        }
        else if (result == 2) {
          resultText = "ROLL:" + result + "|SMALL-4|LARGE-2|HUGE-1|";
        }
        else if (result == 1) {
          resultText = "ROLL:" + result + " |SMALL-6|LARGE-4|HUGE-2|";
        }
        else resultText = "NO REINFORCEMENTS";
        return resultText;
      }

      //On click event roll the dice and apply the result
      $('#reinforcementButton').click(
        function () {
          $('#result').text(reinforce(0));
          //generateResult(0, $('#reinforcementResult'), $('#eventDetailDescr'))
        }

      )


      $('#blackstoneRoll').hide();
      $('#resetHostilesButton').hide();

      // click handler â€” expand if any visible is collapsed, otherwise collapse all visible
      $('#toggleHostileCollapseButton').click(function () {
        var $visible = $('#hostilesButtonGroup > .container-fluid:visible');
        var anyCollapsed = false;
        $visible.each(function () {
          if (!$(this).find('.collapse.multi-collapse').hasClass('show')) anyCollapsed = true;
        });

        if (anyCollapsed) {
          $visible.each(function () { $(this).find('.collapse.multi-collapse').collapse('show'); });
        } else {
          $visible.each(function () { $(this).find('.collapse.multi-collapse').collapse('hide'); });
        }
        // update label after toggle (small delay for bootstrap animation)
        setTimeout(updateToggleLabel, 150);
      });

      // keep label in sync when hostiles are shown/hidden or individual collapse changes
      $('#multiHostileSelect').on('change', updateToggleLabel);
      $('#generateHostileButton, #clearHostileListButon').on('click', function () { setTimeout(updateToggleLabel, 100); });
      $(document).on('shown.bs.collapse hidden.bs.collapse', '#hostilesButtonGroup .collapse', updateToggleLabel);

      // initial state
      updateToggleLabel();
    });


</script>

<body>
  <div class="container-fluid">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="#">Blackstone Fortress</a>
    </nav>
    <div class="card bg-secondary">
      <div class="card-body">
        <div class="form-group">
          <h6 class="card-title text-white">Event Table</h6>
          <div class="input-group mb-3" style="margin-right:5px">
            <select class="custom-select bg-dark text-white" name="" id="multiEventSelect">
              <option value="EventHV">Quest for the Hidden Vault (Core)</option>
              <option value="EventBS">Quest for the Black Shrines (Escalation)</option>
              <option value="EventSQ">Shardquake Event (Deadly Alliance)</option>
              <option value="EventSH">Seethe Event (Deadly Alliance)</option>
              <option value="EventA0">Ascension (No Hostiles)</option>
              <option value="EventA1">Ascension (1+ Hostiles) </option>
            </select>
            <button class="btn btn-outline-light" id="eventButton" data-toggle="modal" data-target="#eventModal">Roll
              Event</button>
          </div>

        </div>
        <div class="form-group" id="hostileGroupSelection">
          <h6 class="card-title text-white">Select Hostiles</h6>
          <select multiple class="custom-select bg-dark text-white" name="" id="multiHostileSelect">
            <option value="TG">Traitor Guardsmen</option>
            <option value="NG">Negavolt Cultists</option>
            <option value="UG">Ur-Ghuls</option>
            <option value="SD">Spindle Drones</option>
            <option value="GD">Guardian Drone</option>
            <option value="CB">Chaos Beastman</option>
            <option value="RP">Rogue Psykers</option>
            <option value="CSM">Chaos Space Marines</option>
            <option value="OM">Obsidious Mallex</option>
            <option value="CL">Cultist</option>
            <option value="CF">Cultist Firebrand</option>
            <option value="AM">Ambull</option>
            <option value="BI">Borewyrm Infestation</option>
            <option value="TC">Traitor Commissar</option>
            <option value="CO">Chaos Ogryn</option>
            <option value="PM">Plague Marine</option>
            <option value="PW">Poxwalker</option>
            <option value="GP">Greater Possessed</option>
            <option value="MOP">Master of Possession</option>
          </select>
        </div>
        <div class="text-center"><button type="button" class="btn btn-dark" id="clearHostileListButon">Clear
            Selection</button>
          <button type="button" class="btn btn-danger" id="generateHostileButton">Show All Hostiles</button>
          <button type="button" class="btn btn-secondary" id="toggleHostileCollapseButton">Expand All</button>
        </div>
      </div>
      <!-- Traitor Guardsmen-->
      <div id="hostilesButtonGroup">
        <div class="container-fluid" id="TGButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="TGButtonD" data-toggle="collapse"
            data-target="#TGCard">Traitor Guardsmen</button>
          <div class="collapse multi-collapse" id="TGCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="TGSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="TGMoveStats"></span>, <strong>Wounds: </strong><span
                              id="TGWoundStats"></span></span>
                          <span class="line2" id="TGStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="TGHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="TGEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="TGCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="TGCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="TGOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" name="" id="TGCheckBox" value="TG">
                    <label class="form-check-label" for="TGCheckBox">
                      Traitor Commissar Motivation Active
                    </label>
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="TGStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="TGResultValue">&nbsp;</h5>
                <p class="card-text" id="TGResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- NEGAVOLT-->
        <div class="container-fluid" id="NGButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="NGButtonD" data-toggle="collapse"
            data-target="#NGCard">Negavolt Cultist</button>
          <div class="collapse multi-collapse" id="NGCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="NGSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="NGMoveStats"></span>, <strong>Wounds: </strong><span
                              id="NGWoundStats"></span></span>
                          <span class="line2" id="NGStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="NGHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="NGEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="NGOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="NGStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="NGResultValue">&nbsp;</h5>
                <p class="card-text" id="NGResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- SPINDLE DRONES-->
        <div class="container-fluid" id="SDButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="SDButtonD" data-toggle="collapse"
            data-target="#SDCard">Spindle Drone</button>
          <div class="collapse multi-collapse" id="SDCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="SDSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="SDMoveStats"></span>, <strong>Wounds: </strong><span
                              id="SDWoundStats"></span></span>
                          <span class="line2" id="SDStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="SDHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="SDEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="SDCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="SDCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="SDOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" name="" id="SDAwakened" value="SD">
                    <label class="form-check-label" for="SDAwakened">
                      Awakened
                    </label>
                  </div>
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" name="" id="enhancedAISD" value="SDAI">
                    <label class="form-check-label" for="enhancedAISD">
                      Enhanced Intelligence
                    </label>
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="SDStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="SDResultValue">&nbsp;</h5>
                <p class="card-text" id="SDResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- GUARDIAN DRONE-->
        <div class="container-fluid" id="GDButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="GDButtonD" data-toggle="collapse"
            data-target="#GDCard">Guardian Drone</button>
          <div class="collapse multi-collapse" id="GDCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="GDSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="GDMoveStats"></span>, <strong>Wounds: </strong><span
                              id="GDWoundStats"></span></span>
                          <span class="line2" id="GDStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="GDHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="GDEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="GDCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="GDCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="GDOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" name="" id="enhancedAIGD" value="GD">
                    <label class="form-check-label" for="enhancedAIGD">
                      Enhanced Intelligence
                    </label>
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="GDStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="GDResultValue">&nbsp;</h5>
                <p class="card-text" id="GDResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- UR-GHULS-->
        <div class="container-fluid" id="UGButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="UGButtonD" data-toggle="collapse"
            data-target="#UGCard">Ur-Ghuls</button>
          <div class="collapse multi-collapse" id="UGCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="UGSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="UGMoveStats"></span>, <strong>Wounds: </strong><span
                              id="UGWoundStats"></span></span>
                          <span class="line2" id="UGStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="UGHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="UGEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="UGCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="UGOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="UGStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="UGResultValue">&nbsp;</h5>
                <p class="card-text" id="UGResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          </br>
        </div>
        <!-- CHAOS BEASTMAN-->
        <div class="container-fluid" id="CBButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="CBButtonD" data-toggle="collapse"
            data-target="#CBCard">Chaos Beastman</button>
          <div class="collapse multi-collapse" id="CBCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="CBSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="CBMoveStats"></span>, <strong>Wounds: </strong><span
                              id="CBWoundStats"></span></span>
                          <span class="line2" id="CBStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="CBHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="CBEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="CBCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="CBOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="CBStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="CBResultValue">&nbsp;</h5>
                <p class="card-text" id="CBResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- ROGUE PSYKER -->
        <div class="container-fluid" id="RPButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="RPButtonD" data-toggle="collapse"
            data-target="#RPCard">Rogue Psyker</button>
          <div class="collapse multi-collapse" id="RPCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="RPSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="RPMoveStats"></span>, <strong>Wounds: </strong><span
                              id="RPWoundStats"></span></span>
                          <span class="line2" id="RPStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="RPHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="RPEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="RPCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="RPOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="RPStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="RPResultValue">&nbsp;</h5>
                <p class="card-text" id="RPResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- CHAOS SPACE MARINE -->
        <div class="container-fluid" id="CSMButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="CSMButtonD" data-toggle="collapse"
            data-target="#CSMCard">Chaos Space Marine</button>
          <div class="collapse multi-collapse" id="CSMCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="CSMSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="CSMMoveStats"></span>, <strong>Wounds: </strong><span
                              id="CSMWoundStats"></span></span>
                          <span class="line2" id="CSMStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="CSMHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="CSMEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="CSMCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="CSMCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="CSMOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="CSMStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="CSMResultValue">&nbsp;</h5>
                <p class="card-text" id="CSMResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- OBSIDIUS MALLEX -->
        <div class="container-fluid" id="OMButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="OMButtonD" data-toggle="collapse"
            data-target="#OMCard">Obsidius Mallex</button>
          <div class="collapse multi-collapse" id="OMCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="OMSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="OMMoveStats"></span>, <strong>Wounds: </strong><span
                              id="OMWoundStats"></span></span>
                          <span class="line2" id="OMStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="OMHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="OMEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="OMCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="OMCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="OMOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" name="" id="OMEmpowered" value="OM">
                    Empowered
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="OMStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="OMResultValue">&nbsp;</h5>
                <p class="card-text" id="OMResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- AMBULL-->
        <div class="container-fluid" id="AMButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="AMButtonD" data-toggle="collapse"
            data-target="#AMCard">Ambull</button>
          <div class="collapse multi-collapse" id="AMCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="AMSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="AMMoveStats"></span>, <strong>Wounds: </strong><span
                              id="AMWoundStats"></span></span>
                          <span class="line2" id="AMStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="AMHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="AMEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="AMCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary"
                          id="AMProtectiveButton">Protective/Enraged</button>
                        <button type="button" class="btn btn-secondary" id="AMOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="AMCheckBox" value="AM">
                    Enraged
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="AMStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="AMResultValue">&nbsp;</h5>
                <p class="card-text" id="AMResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!-- BOREWYRM-->
        <div class="container-fluid" id="BIButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="BIButtonD" data-toggle="collapse"
            data-target="#BICard">Borewyrm Infestation</button>
          <div class="collapse multi-collapse" id="BICard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="BISpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="BIMoveStats"></span>, <strong>Wounds: </strong><span
                              id="BIWoundStats"></span></span>
                          <span class="line2" id="BIStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="BIHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="BIEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="BICoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="BICloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="BIOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="BIStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="BIResultValue">&nbsp;</h5>
                <p class="card-text" id="BIResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--TRAITOR COMMISSAR-->
        <div class="container-fluid" id="TCButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="TCButtonD" data-toggle="collapse"
            data-target="#TCCard">Traitor Commissar</button>
          <div class="collapse multi-collapse" id="TCCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="TCSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="TCMoveStats"></span>, <strong>Wounds: </strong><span
                              id="TCWoundStats"></span></span>
                          <span class="line2" id="TCStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="TCHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="TCEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="TCCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="TCCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="TCOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="TCStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="TCResultValue">&nbsp;</h5>
                <p class="card-text" id="TCResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--CHAOS OGRYN-->
        <div class="container-fluid" id="COButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="COButtonD" data-toggle="collapse"
            data-target="#COCard">Chaos Ogryn</button>
          <div class="collapse multi-collapse" id="COCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="COSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="COMoveStats"></span>, <strong>Wounds: </strong><span
                              id="COWoundStats"></span></span>
                          <span class="line2" id="COStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="COBodyguardButton">Bodyguard</button>
                        <button type="button" class="btn btn-secondary" id="COHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="COEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="COCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="COOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="COStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="COResultValue">&nbsp;</h5>
                <p class="card-text" id="COResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--POXWALKER-->
        <div class="container-fluid" id="PWButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="PWButtonD" data-toggle="collapse"
            data-target="#PWCard">Poxwalker</button>
          <div class="collapse multi-collapse" id="PWCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="PWSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="PWMoveStats"></span>, <strong>Wounds: </strong><span
                              id="PWWoundStats"></span></span>
                          <span class="line2" id="PWStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="PWHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="PWEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="PWOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="PWStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="PWResultValue">&nbsp;</h5>
                <p class="card-text" id="PWResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--PLAGUE MARINE-->
        <div class="container-fluid" id="PMButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="PMButtonD" data-toggle="collapse"
            data-target="#PMCard">Plague Marine</button>
          <div class="collapse multi-collapse" id="PMCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="PMSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="PMMoveStats"></span>, <strong>Wounds: </strong><span
                              id="PMWoundStats"></span></span>
                          <span class="line2" id="PMStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="PMHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="PMEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="PMCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="PMCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="PMOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="PMStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="PMResultValue">&nbsp;</h5>
                <p class="card-text" id="PMResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--MASTER OF POSSESSION-->
        <div class="container-fluid" id="MOPButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="MOPButtonD" data-toggle="collapse"
            data-target="#MOPCard">Master of Possession</button>
          <div class="collapse multi-collapse" id="MOPCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="MOPSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="MOPMoveStats"></span>, <strong>Wounds: </strong><span
                              id="MOPWoundStats"></span></span>
                          <span class="line2" id="MOPStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="MOPHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="MOPEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="MOPCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="MOPCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="MOPOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="MOPStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="MOPResultValue">&nbsp;</h5>
                <p class="card-text" id="MOPResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--GREATER POSSESSED-->
        <div class="container-fluid" id="GPButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="GPButtonD" data-toggle="collapse"
            data-target="#GPCard">Greater Possessed</button>
          <div class="collapse multi-collapse" id="GPCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="GPSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="GPMoveStats"></span>, <strong>Wounds: </strong><span
                              id="GPWoundStats"></span></span>
                          <span class="line2" id="GPStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="GPHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="GPEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="GPCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="GPOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="GPStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="GPResultValue">&nbsp;</h5>
                <p class="card-text" id="GPResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--CULTIST -->
        <div class="container-fluid" id="CLButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="CLButtonD" data-toggle="collapse"
            data-target="#CLCard">Cultist</button>
          <div class="collapse multi-collapse" id="CLCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="CLSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="CLMoveStats"></span>, <strong>Wounds: </strong><span
                              id="CLWoundStats"></span></span>
                          <span class="line2" id="CLStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="CLHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="CLEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="CLCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="CLCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="CLOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                  <!-- Check box here -->
                  <div class="form-check">
                    <input type="checkbox" class="form-check-input" id="CLCheckBox" value="CL">
                    Rousing Figurehead Active
                  </div>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="CLStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="CLResultValue">&nbsp;</h5>
                <p class="card-text" id="CLResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--CULTIST FIREBRAND -->
        <div class="container-fluid" id="CFButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="CFButtonD" data-toggle="collapse"
            data-target="#CFCard">Cultist Firebrand</button>
          <div class="collapse multi-collapse" id="CFCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="CFSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="CFMoveStats"></span>, <strong>Wounds: </strong><span
                              id="CFWoundStats"></span></span>
                          <span class="line2" id="CFStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="CFHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="CFEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="CFCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="CFCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="CFOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="CFStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="CFResultValue">&nbsp;</h5>
                <p class="card-text" id="CFResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>
        <!--ARCH*** -->
        <div class="container-fluid" id="ARCButton">
          <button type="button" class="btn btn-dark btn-block btn-lg" id="ARCButtonD" data-toggle="collapse"
            data-target="#ARCCard">The Archivist</button>
          <div class="collapse multi-collapse" id="ARCCard">
            <div class="card text-center">
              <div class="card-header">
                <!-- Special Rules list (Left side) -->
                <div class="special-rules-list" id="ARCSpecialRules"></div>
                <!-- Main panel (Middle) -->
                <div class="mid-column">
                  <ul class="nav nav-pills card-header-pills justify-content-center">
                    <li class="nav-item">
                      <div class="btn-group-sm" role="group" aria-label="Basic example">
                        <!-- Add Stats line-->
                        <span class="stats-display">
                          <span><strong>Move: </strong><span id="ARCMoveStats"></span>, <strong>Wounds: </strong><span
                              id="ARCWoundStats"></span></span>
                          <span class="line2" id="ARCStatline2"></span>
                        </span>
                        <!-- Activation buttons here -->
                        <button type="button" class="btn btn-secondary" id="ARCHiddenButton">Hidden</button>
                        <button type="button" class="btn btn-secondary" id="ARCEngagedButton">Engaged</button>
                        <button type="button" class="btn btn-secondary" id="ARCCoverButton">In Cover</button>
                        <button type="button" class="btn btn-secondary" id="ARCCloseButton">Close</button>
                        <button type="button" class="btn btn-secondary" id="ARCOtherButton">Other</button>
                      </div>
                    </li>
                  </ul>
                </div>
                <!-- stats matrix (right side) -->
                <div class="stats-table" id="ARCStatsTable"></div>
              </div>
              <div class="card-body">
                <h5 class="card-title" id="ARCResultValue">&nbsp;</h5>
                <p class="card-text" id="ARCResultDescr">&nbsp;</p>
                <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
              </div>
            </div>
          </div>
          <br />
        </div>

      </div>
    </div>
  </div>

  <!-- Event Modal -->
  <div class="modal fade" id="eventModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="card-body bg-dark text-white">
          <h5 class="card-title" id="eventTitleDescr">&nbsp;</h5>
          <p class="card-text" id="eventDetailDescr">&nbsp;</p>
          <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
        </div>
      </div>
    </div>
  </div>
  <!-- Reinforcement Modal -->
  <div class="modal fade" id="reinforcementModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="card-body">
          <p class="card-text" id="result">&nbsp;</p>
          <!--<a href="#" class="btn btn-primary">Go somewhere</a>-->
        </div>
      </div>
    </div>
  </div>
</body>

</html>